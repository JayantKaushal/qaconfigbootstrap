<?xml version="1.0" encoding="UTF-8"?><record_update table="wf_workflow_version">
    <wf_workflow_version action="INSERT_OR_UPDATE">
        <active>true</active>
        <activity_stages>{"ends":["d1e74e4287821300297bf4bbe3e3ec31"],"activities":{"55e74e4287821300297bf4bbe3e3ec35":"45e70e4287821300297bf4bbe3e3ec44","59e74e4287821300297bf4bbe3e3ec33":"41e70e4287821300297bf4bbe3e3ec44","d9e74e4287821300297bf4bbe3e3ec27":"c9e70e4287821300297bf4bbe3e3ec45","49e70e4287821300297bf4bbe3e3ec46":"c9e70e4287821300297bf4bbe3e3ec44","55e74e4287821300297bf4bbe3e3ec34":"41e70e4287821300297bf4bbe3e3ec46","1de74e4287821300297bf4bbe3e3ec2b":"c5e70e4287821300297bf4bbe3e3ec45","19e74e4287821300297bf4bbe3e3ec2a":"49e70e4287821300297bf4bbe3e3ec45","19e74e4287821300297bf4bbe3e3ec2c":"c5e70e4287821300297bf4bbe3e3ec44","d9e74e4287821300297bf4bbe3e3ec24":"4de70e4287821300297bf4bbe3e3ec45","19e74e4287821300297bf4bbe3e3ec28":"41e70e4287821300297bf4bbe3e3ec44","95e74e4287821300297bf4bbe3e3ec2e":"41e70e4287821300297bf4bbe3e3ec45","91e74e4287821300297bf4bbe3e3ec2f":"49e70e4287821300297bf4bbe3e3ec44","d1e70e4287821300297bf4bbe3e3ec49":"cde70e4287821300297bf4bbe3e3ec45","d1e74e4287821300297bf4bbe3e3ec38":"c5e70e4287821300297bf4bbe3e3ec45","d5e74e4287821300297bf4bbe3e3ec25":"41e70e4287821300297bf4bbe3e3ec44"},"stages":{"41e70e4287821300297bf4bbe3e3ec44":{"name":"Deploying Stack","value":"deploying stack","order":300,"duration":"","stageId":"41e70e4287821300297bf4bbe3e3ec44"},"cde70e4287821300297bf4bbe3e3ec45":{"name":"Deployment Failed","value":"deployment_failed_cancelled","order":1330,"duration":"","stageId":"cde70e4287821300297bf4bbe3e3ec45"},"49e70e4287821300297bf4bbe3e3ec44":{"name":"Deployment Successful","value":"Deployment Successful","order":1400,"duration":"","stageId":"49e70e4287821300297bf4bbe3e3ec44"},"c9e70e4287821300297bf4bbe3e3ec44":{"name":"Deployment Cancelled","value":"Deployment Cancelled","order":1320,"duration":"","stageId":"c9e70e4287821300297bf4bbe3e3ec44"},"c9e70e4287821300297bf4bbe3e3ec45":{"name":"Capacity Check Failed","value":"capacity_check_failed","order":115,"duration":"","stageId":"c9e70e4287821300297bf4bbe3e3ec45"},"49e70e4287821300297bf4bbe3e3ec45":{"name":"Waiting for Cloud Request Approval","value":"Waiting for Cloud Request Approval","order":102,"duration":"","stageId":"49e70e4287821300297bf4bbe3e3ec45"},"45e70e4287821300297bf4bbe3e3ec44":{"name":"Quota Check Failed","value":"quota_check_failed","order":110,"duration":"","stageId":"45e70e4287821300297bf4bbe3e3ec44"},"41e70e4287821300297bf4bbe3e3ec45":{"name":"Retrying Stack Deployment","value":"Retrying Stack Deployment","order":1150,"duration":"","stageId":"41e70e4287821300297bf4bbe3e3ec45"},"41e70e4287821300297bf4bbe3e3ec46":{"name":"Apply BlueprintProvision Policy","value":"Apply BlueprintProvision Policy","order":100,"duration":"","stageId":"41e70e4287821300297bf4bbe3e3ec46"},"c5e70e4287821300297bf4bbe3e3ec45":{"name":"Cloud Request Approved","value":"request_approved","order":103,"duration":"","stageId":"c5e70e4287821300297bf4bbe3e3ec45"},"c5e70e4287821300297bf4bbe3e3ec44":{"name":"Quota/Capacity Check Successful","value":"Quota/Capacity Check Successful","order":150,"duration":"","stageId":"c5e70e4287821300297bf4bbe3e3ec44"},"4de70e4287821300297bf4bbe3e3ec45":{"name":"Cloud Request Rejected","value":"approval_rejected","order":103,"duration":"","stageId":"4de70e4287821300297bf4bbe3e3ec45"}},"subflows":[]}</activity_stages>
        <after_business_rules>false</after_business_rules>
        <checked_out/>
        <checked_out_by/>
        <column_renderer display_value="Workflow-driven">a56213111b030100adca1e094f0713ac</column_renderer>
        <condition/>
        <condition_type/>
        <description/>
        <expected_sequences>91e74e4287821300297bf4bbe3e3ec36,91e70e4287821300297bf4bbe3e3ec4c,19e74e4287821300297bf4bbe3e3ec29,d1e74e4287821300297bf4bbe3e3ec23,55e74e4287821300297bf4bbe3e3ec34,dde70e4287821300297bf4bbe3e3ec49,51e70e4287821300297bf4bbe3e3ec4b,19e74e4287821300297bf4bbe3e3ec2a,dde74e4287821300297bf4bbe3e3ec31,1de74e4287821300297bf4bbe3e3ec2b,15e74e4287821300297bf4bbe3e3ec2d,19e74e4287821300297bf4bbe3e3ec2c,dde74e4287821300297bf4bbe3e3ec36,59e74e4287821300297bf4bbe3e3ec33,d5e74e4287821300297bf4bbe3e3ec25,91e74e4287821300297bf4bbe3e3ec2f,d1e70e4287821300297bf4bbe3e3ec48,d5e74e4287821300297bf4bbe3e3ec26,d1e74e4287821300297bf4bbe3e3ec31</expected_sequences>
        <expected_time>1970-01-01 14:00:00</expected_time>
        <expected_time_type/>
        <full_sequences>91e74e4287821300297bf4bbe3e3ec36,91e70e4287821300297bf4bbe3e3ec4c,19e74e4287821300297bf4bbe3e3ec29,d1e74e4287821300297bf4bbe3e3ec23,d1e70e4287821300297bf4bbe3e3ec49,55e74e4287821300297bf4bbe3e3ec34,d1e74e4287821300297bf4bbe3e3ec31,dde70e4287821300297bf4bbe3e3ec49,51e70e4287821300297bf4bbe3e3ec4b,55e74e4287821300297bf4bbe3e3ec35,d9e74e4287821300297bf4bbe3e3ec27,19e74e4287821300297bf4bbe3e3ec2a,d1e74e4287821300297bf4bbe3e3ec38,9de74e4287821300297bf4bbe3e3ec2f,dde74e4287821300297bf4bbe3e3ec31,19e74e4287821300297bf4bbe3e3ec2c,15e74e4287821300297bf4bbe3e3ec2d,49e70e4287821300297bf4bbe3e3ec46,1de74e4287821300297bf4bbe3e3ec2b,d9e74e4287821300297bf4bbe3e3ec24,dde74e4287821300297bf4bbe3e3ec36,59e74e4287821300297bf4bbe3e3ec33,95e74e4287821300297bf4bbe3e3ec2e,d5e74e4287821300297bf4bbe3e3ec25,91e74e4287821300297bf4bbe3e3ec2f,19e74e4287821300297bf4bbe3e3ec28,d1e70e4287821300297bf4bbe3e3ec48,d5e74e4287821300297bf4bbe3e3ec26</full_sequences>
        <journal/>
        <max_activity_count>10000</max_activity_count>
        <name>Blueprint Request</name>
        <not_cacheable>false</not_cacheable>
        <on_cancel><![CDATA[// This script executes if the workflow is cancelled.// The global variable context_sys_id contains the sys_id of the cancelled workflow context.]]></on_cancel>
        <order>100</order>
        <pin_type>set_by_activity</pin_type>
        <published>true</published>
        <relative_duration display_value="2 business days by 4pm">3bf802c20a0a0b52008e2859cd8abcf2</relative_duration>
        <requires_ert>true</requires_ert>
        <run_multiple>false</run_multiple>
        <schedule/>
        <stage_field>stage</stage_field>
        <stage_order>user_specified</stage_order>
        <start display_value="Begin">91e74e4287821300297bf4bbe3e3ec36</start>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>c5e70e4287821300297bf4bbe3e3ec42</sys_id>
        <sys_mod_count>5</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-08-30 10:46:18</sys_updated_on>
        <table>sc_req_item</table>
        <timezone/>
        <validated>true</validated>
        <workflow display_value="Blueprint Request">2cbfd46eeb352200979aa5115206fe99</workflow>
    </wf_workflow_version>
    <wf_workflow action="INSERT_OR_UPDATE">
        <access>public</access>
        <description/>
        <name>Blueprint Request</name>
        <preview/>
        <sys_class_name>wf_workflow</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2016-09-14 06:24:42</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>2cbfd46eeb352200979aa5115206fe99</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>Blueprint Request</sys_name>
        <sys_overrides/>
        <sys_package display_value="Cloud Management Platform" source="sn_cmp">80d50579eb203200979aa5115206fedd</sys_package>
        <sys_policy/>
        <sys_scope display_value="Cloud Management Platform">80d50579eb203200979aa5115206fedd</sys_scope>
        <sys_update_name>wf_workflow_2cbfd46eeb352200979aa5115206fe99</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2016-09-14 06:24:42</sys_updated_on>
        <table>sc_req_item</table>
        <template>false</template>
        <vars/>
    </wf_workflow>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Apply BlueprintProvision Policy</name>
        <ola>1970-01-01 00:00:00</ola>
        <order>100</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>41e70e4287821300297bf4bbe3e3ec46</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>Apply BlueprintProvision Policy</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Cloud Request Rejected</name>
        <ola>1970-01-01 00:00:00</ola>
        <order>103</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>4de70e4287821300297bf4bbe3e3ec45</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>approval_rejected</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Assessing Failure</name>
        <ola>1970-01-01 00:00:00</ola>
        <order>1115</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>cde70e4287821300297bf4bbe3e3ec43</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>Assessing Failure</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Capacity Check Failed</name>
        <ola>1970-01-01 00:00:00</ola>
        <order>115</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>c9e70e4287821300297bf4bbe3e3ec45</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>capacity_check_failed</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Delivery</name>
        <ola>1970-01-03 00:00:00</ola>
        <order>140</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>c1e70e4287821300297bf4bbe3e3ec46</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>delivery</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Deploying Stack</name>
        <ola>1970-01-01 00:00:00</ola>
        <order>300</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>41e70e4287821300297bf4bbe3e3ec44</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>deploying stack</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Deployment Cancelled</name>
        <ola>1970-01-01 00:00:00</ola>
        <order>1320</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>c9e70e4287821300297bf4bbe3e3ec44</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>Deployment Cancelled</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Deployment Successful</name>
        <ola>1970-01-01 00:00:00</ola>
        <order>1400</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>49e70e4287821300297bf4bbe3e3ec44</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>Deployment Successful</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Deployment Failed</name>
        <ola>1970-01-01 00:00:00</ola>
        <order>1330</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>cde70e4287821300297bf4bbe3e3ec45</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>deployment_failed_cancelled</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Fulfillment</name>
        <ola>1970-01-02 00:00:00</ola>
        <order>120</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>c1e70e4287821300297bf4bbe3e3ec45</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>fulfillment</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Quota/Capacity Check Successful</name>
        <ola>1970-01-01 00:00:00</ola>
        <order>150</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>c5e70e4287821300297bf4bbe3e3ec44</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>Quota/Capacity Check Successful</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Quota Check Failed</name>
        <ola>1970-01-01 00:00:00</ola>
        <order>110</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>45e70e4287821300297bf4bbe3e3ec44</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>quota_check_failed</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Cloud Request Cancelled</name>
        <ola>1970-01-01 00:00:00</ola>
        <order>1310</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>4de70e4287821300297bf4bbe3e3ec44</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>Request Cancelled</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Cloud Request Approved</name>
        <ola>1970-01-01 00:00:00</ola>
        <order>103</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>c5e70e4287821300297bf4bbe3e3ec45</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>request_approved</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Retrying Stack Deployment</name>
        <ola>1970-01-01 00:00:00</ola>
        <order>1150</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>41e70e4287821300297bf4bbe3e3ec45</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>Retrying Stack Deployment</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Task Created for Operator</name>
        <ola>1970-01-01 00:00:00</ola>
        <order>1300</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>c1e70e4287821300297bf4bbe3e3ec44</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>Task Created for Operator</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Task Created for User</name>
        <ola>1970-01-01 00:00:00</ola>
        <order>1200</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>cde70e4287821300297bf4bbe3e3ec44</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>Task Created for User</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Waiting for Cloud Request Approval</name>
        <ola>1970-01-01 00:00:00</ola>
        <order>102</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>49e70e4287821300297bf4bbe3e3ec45</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>Waiting for Cloud Request Approval</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_stage action="INSERT_OR_UPDATE">
        <name>Waiting for Approval</name>
        <ola>1970-01-02 00:00:00</ola>
        <order>101</order>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>45e70e4287821300297bf4bbe3e3ec45</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>waiting_for_approval</value>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_stage>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Script">db8c65aec0a8016501d00259bc7203a4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>12</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Apply BlueprintProvision Policy</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage display_value="Apply BlueprintProvision Policy">41e70e4287821300297bf4bbe3e3ec46</stage>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>55e74e4287821300297bf4bbe3e3ec34</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>25</x>
        <y>476</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=55e74e4287821300297bf4bbe3e3ec34"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>55e74e4287821300297bf4bbe3e3ec34</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e74e4287821300297bf4bbe3e3ec34</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>activity.result = 'skip';&#13;
&#13;
// If its a new order, then only trigger the policy&#13;
if(workflow.scratchpad.submitCount == 1) {&#13;
	invokePolicy();&#13;
}&#13;
&#13;
function invokePolicy() {&#13;
	var policyUtil = new sn_cmp.CloudPolicyUtil();&#13;
&#13;
	// Apply policy rules which evaluate conditions and return context data with applied values&#13;
	var object = policyUtil.invokePolicy(current, "", "Blueprint", "provision", "blueprint", current.cat_item.blue_print + '');&#13;
&#13;
	createCloudTrail('Invoke Policy Engine', '1', false, 'Policy response payload', object);&#13;
&#13;
	workflow.scratchpad.transformedPayload  = new global.JSON().decode(object);&#13;
	var blueprintSysid = current.cat_item.blue_print + '';&#13;
	var blueprintRequestUtil = new BlueprintRequestUtil();&#13;
&#13;
	if(!gs.nil(workflow.scratchpad.transformedPayload) ) {&#13;
		// If any hard error occurs while applying policies then make the activity result abort&#13;
		if(workflow.scratchpad.transformedPayload.error) {&#13;
			activity.result = 'abort';&#13;
			createCloudTrail('Apply Policy', '4', true, 'Unexpected error from policy engine.', workflow.scratchpad.transformedPayload.message);&#13;
		}&#13;
		if(workflow.scratchpad.transformedPayload.abortProcess) {&#13;
			activity.result = 'abort';&#13;
			workflow.info("Aborting WF: " + workflow.scratchpad.transformedPayload.message);&#13;
			createCloudTrail('Apply Policy', '4', true, 'Aborting Blueprint Request WF: ' + workflow.scratchpad.transformedPayload.message, '');&#13;
		}&#13;
		// If any of the policy rules gets applied then successful is true. In that case process req item.&#13;
		else if(workflow.scratchpad.transformedPayload.successful){&#13;
			activity.result = 'success';&#13;
			if(!gs.nil(workflow.scratchpad.transformedPayload.logs)) {&#13;
				var logs = new global.JSON().decode(workflow.scratchpad.transformedPayload.logs);&#13;
				createCloudTrail('Apply Policy', '2', true, 'Blueprint Request WF: ' + logs.message, logs.rules);&#13;
			}&#13;
&#13;
			// Store tranformed variables into request item's variables&#13;
			var data = workflow.scratchpad.transformedPayload.contextData;&#13;
			for (var key in data) {&#13;
				//current.variables[key] = data[key];&#13;
				workflow.scratchpad.payload.orderFormData[key] = blueprintRequestUtil.resolveParamValue( data[key], key, blueprintSysid);&#13;
				&#13;
				// To honor the sequence of steps followed by change in value, use req item instead of current&#13;
				var reqItem = new GlideRecord('sc_req_item');&#13;
				if(reqItem.get(current.sys_id)) {&#13;
					reqItem.variables[key] = data[key];&#13;
					reqItem.update();&#13;
					maintainAudit(key);&#13;
				}&#13;
			}			&#13;
		}&#13;
		workflow.info(workflow.scratchpad.transformedPayload.message);&#13;
	}&#13;
}&#13;
&#13;
// Creates an entry in cloud audit log to note down the source of change&#13;
function maintainAudit(key) {&#13;
	var gr = new GlideRecord('sys_audit');&#13;
	gr.addQuery('tablename', 'sc_req_item');&#13;
	gr.addQuery('documentkey', current.sys_id + '');&#13;
	gr.addQuery('fieldname', 'VARIABLE:' + key);&#13;
	gr.orderByDesc('sys_created_on');&#13;
	gr.query();&#13;
	if(gr.next()) {&#13;
		var grA = new GlideRecord('sn_cmp_audit_log');&#13;
		grA.initialize();&#13;
		grA.audit_log =  gr.sys_id;&#13;
		grA.source = '1';&#13;
		grA.insert();&#13;
	}&#13;
}&#13;
&#13;
function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
	var catalogItemId = '' + current.cat_item;&#13;
	var requestItemId = '' + current.sys_id;&#13;
	var orderId ='';&#13;
	var contextKey = '';&#13;
	var stackId = '';&#13;
	var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
	var targetInstanceId = '';&#13;
	var userId = '' + current.request.requested_for;&#13;
	var groupId = '' + workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
	var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
}&#13;
&#13;
&#13;
</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>55e74e4287821300297bf4bbe3e3ec34</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e74e4287821300297bf4bbe3e3ec34</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>activity.result = 'skip';&#13;
&#13;
// If its a new order, then only trigger the policy&#13;
if(workflow.scratchpad.submitCount == 1) {&#13;
	invokePolicy();&#13;
}&#13;
&#13;
function invokePolicy() {&#13;
	var policyUtil = new sn_cmp.CloudPolicyUtil();&#13;
&#13;
	// Apply policy rules which evaluate conditions and return context data with applied values&#13;
	var object = policyUtil.invokePolicy(current, "", "Blueprint", "provision", "blueprint", current.cat_item.blue_print + '');&#13;
&#13;
	createCloudTrail('Invoke Policy Engine', '1', false, 'Policy response payload', object);&#13;
&#13;
	workflow.scratchpad.transformedPayload  = new global.JSON().decode(object);&#13;
	var blueprintSysid = current.cat_item.blue_print + '';&#13;
	var blueprintRequestUtil = new BlueprintRequestUtil();&#13;
&#13;
	if(!gs.nil(workflow.scratchpad.transformedPayload) ) {&#13;
		// If any hard error occurs while applying policies then make the activity result abort&#13;
		if(workflow.scratchpad.transformedPayload.error) {&#13;
			activity.result = 'abort';&#13;
			createCloudTrail('Apply Policy', '4', true, 'Unexpected error from policy engine.', workflow.scratchpad.transformedPayload.message);&#13;
		}&#13;
		if(workflow.scratchpad.transformedPayload.abortProcess) {&#13;
			activity.result = 'abort';&#13;
			workflow.info("Aborting WF: " + workflow.scratchpad.transformedPayload.message);&#13;
			createCloudTrail('Apply Policy', '4', true, 'Aborting Blueprint Request WF: ' + workflow.scratchpad.transformedPayload.message, '');&#13;
		}&#13;
		// If any of the policy rules gets applied then successful is true. In that case process req item.&#13;
		else if(workflow.scratchpad.transformedPayload.successful){&#13;
			activity.result = 'success';&#13;
			if(!gs.nil(workflow.scratchpad.transformedPayload.logs)) {&#13;
				var logs = new global.JSON().decode(workflow.scratchpad.transformedPayload.logs);&#13;
				createCloudTrail('Apply Policy', '2', true, 'Blueprint Request WF: ' + logs.message, logs.rules);&#13;
			}&#13;
&#13;
			// Store tranformed variables into request item's variables&#13;
			var data = workflow.scratchpad.transformedPayload.contextData;&#13;
			for (var key in data) {&#13;
				//current.variables[key] = data[key];&#13;
				workflow.scratchpad.payload.orderFormData[key] = blueprintRequestUtil.resolveParamValue( data[key], key, blueprintSysid);&#13;
				&#13;
				// To honor the sequence of steps followed by change in value, use req item instead of current&#13;
				var reqItem = new GlideRecord('sc_req_item');&#13;
				if(reqItem.get(current.sys_id)) {&#13;
					reqItem.variables[key] = data[key];&#13;
					reqItem.update();&#13;
					maintainAudit(key);&#13;
				}&#13;
			}			&#13;
		}&#13;
		workflow.info(workflow.scratchpad.transformedPayload.message);&#13;
	}&#13;
}&#13;
&#13;
// Creates an entry in cloud audit log to note down the source of change&#13;
function maintainAudit(key) {&#13;
	var gr = new GlideRecord('sys_audit');&#13;
	gr.addQuery('tablename', 'sc_req_item');&#13;
	gr.addQuery('documentkey', current.sys_id + '');&#13;
	gr.addQuery('fieldname', 'VARIABLE:' + key);&#13;
	gr.orderByDesc('sys_created_on');&#13;
	gr.query();&#13;
	if(gr.next()) {&#13;
		var grA = new GlideRecord('sn_cmp_audit_log');&#13;
		grA.initialize();&#13;
		grA.audit_log =  gr.sys_id;&#13;
		grA.source = '1';&#13;
		grA.insert();&#13;
	}&#13;
}&#13;
&#13;
function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
	var catalogItemId = '' + current.cat_item;&#13;
	var requestItemId = '' + current.sys_id;&#13;
	var orderId ='';&#13;
	var contextKey = '';&#13;
	var stackId = '';&#13;
	var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
	var targetInstanceId = '';&#13;
	var userId = '' + current.request.requested_for;&#13;
	var groupId = '' + workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
	var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
}&#13;
&#13;
&#13;
</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Apply BlueprintProvision Policy">55e74e4287821300297bf4bbe3e3ec34</activity>
        <condition>activity.result == 'abort'</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>abort</name>
        <order>2</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>dde74e4287821300297bf4bbe3e3ec34</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Apply BlueprintProvision Policy">55e74e4287821300297bf4bbe3e3ec34</activity>
        <condition/>
        <condition_default/>
        <condition_type>else_flag</condition_type>
        <else_flag>true</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>skip</name>
        <order>3</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d9e74e4287821300297bf4bbe3e3ec34</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Apply BlueprintProvision Policy">55e74e4287821300297bf4bbe3e3ec34</activity>
        <condition>activity.result == 'success'</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Success</name>
        <order>1</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>5de74e4287821300297bf4bbe3e3ec34</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Script">db8c65aec0a8016501d00259bc7203a4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>14</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Apply BlueprintProvisionApproval Policy</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage/>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>51e70e4287821300297bf4bbe3e3ec4b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>255</x>
        <y>378</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=51e70e4287821300297bf4bbe3e3ec4b"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>51e70e4287821300297bf4bbe3e3ec4b</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d1e70e4287821300297bf4bbe3e3ec4b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>activity.result = 'skip';&#13;
&#13;
// If its a new order, check if approval is required, else skip approval&#13;
if(workflow.scratchpad.submitCount == 1) {&#13;
	invokePolicy();&#13;
}&#13;
&#13;
function invokePolicy() {&#13;
	var nextFlow = '';&#13;
	var invokeApprovalWFPolicy = false;&#13;
	var policyUtil = new sn_cmp.CloudPolicyUtil();&#13;
	// Check if approval is required by invoking CloudProvisionApproval Policy&#13;
	var object = policyUtil.invokePolicy(current, "", "blueprintApproval", "provision", "blueprint", current.cat_item.blue_print + '');&#13;
	workflow.scratchpad.approvalPayload  = new global.JSON().decode(object);&#13;
	&#13;
	if(workflow.scratchpad.approvalPayload != null) {&#13;
		// If any hard error occurs while applying policies then make the activity result abort&#13;
		if(workflow.scratchpad.approvalPayload.error) {&#13;
			activity.result = 'abort';&#13;
			createCloudTrail('Apply Policy', '4', true, 'Unexpected error from policy engine.', workflow.scratchpad.approvalPayload);&#13;
		}&#13;
		if(workflow.scratchpad.approvalPayload.abortProcess) {&#13;
			activity.result = 'abort';&#13;
			createCloudTrail('Apply Policy', '4', true, 'Aborting Blueprint Request WF: ' + workflow.scratchpad.approvalPayload.message, workflow.scratchpad.approvalPayload);&#13;
		}&#13;
		// If any of the policy rules gets applied then successful is true.&#13;
		else if(workflow.scratchpad.approvalPayload.successful &amp;&amp; workflow.scratchpad.approvalPayload.approval != null) {&#13;
			//activity.result = 'success';&#13;
			var approval = {};&#13;
				approval = workflow.scratchpad.approvalPayload.approval;&#13;
				invokeApprovalWFPolicy = true;&#13;
				if(!gs.nil(workflow.scratchpad.approvalPayload.logs)) {&#13;
					var logs = new global.JSON().decode(workflow.scratchpad.approvalPayload.logs);&#13;
					current.description = logs.message + '';&#13;
					createCloudTrail('Apply Policy Rule Action', '2', true, 'Triggering approval WF: ' + logs.message, logs.rules);&#13;
				}&#13;
			}else if( !gs.nil(workflow.scratchpad.approvalPayload.workflowId)){&#13;
				invokeApprovalWFPolicy = true;&#13;
			}&#13;
			&#13;
			workflow.info(workflow.scratchpad.approvalPayload.message);&#13;
		}&#13;
		&#13;
		if(invokeApprovalWFPolicy){&#13;
			if(!gs.nil(policyUtil.getWorkflowName(workflow.scratchpad.approvalPayload.workflowId + '')))&#13;
				nextFlow = policyUtil.getWorkflowName(workflow.scratchpad.approvalPayload.workflowId + '');&#13;
			// If policy does not return approval WF then fall back to default WF&#13;
			if(nextFlow == '') {&#13;
				nextFlow = new global.WorkflowChooser().chooseWorkflowForAction('cloud_approval', current);&#13;
				if (nextFlow == '') {&#13;
					workflow.info("Approval workflow could not be found");&#13;
					gs.info( 'Apply BlueprintProvisionApproval Policy Approval workflow could not be found');&#13;
					createCloudTrail('Apply Policy', '4', true, 'Blueprint Request WF: Approval workflow could not be found', '');&#13;
					activity.result = 'abort';&#13;
				}&#13;
				else&#13;
					activity.result = 'success';&#13;
			}&#13;
			else&#13;
				activity.result = 'success';&#13;
			&#13;
			workflow.scratchpad.approvalWF = nextFlow + '';&#13;
		}&#13;
		&#13;
	}&#13;
	&#13;
	&#13;
	function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
		var catalogItemId = '' + current.cat_item;&#13;
		var requestItemId = '' + current.sys_id;&#13;
		var orderId ='';&#13;
		var contextKey = '';&#13;
		var stackId = '';&#13;
		var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
		var targetInstanceId = '';&#13;
		var userId = '' + current.request.requested_for;&#13;
		var groupId = '' + workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
		var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
	}&#13;
	&#13;
	&#13;
	</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>51e70e4287821300297bf4bbe3e3ec4b</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d1e70e4287821300297bf4bbe3e3ec4b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>activity.result = 'skip';&#13;
&#13;
// If its a new order, check if approval is required, else skip approval&#13;
if(workflow.scratchpad.submitCount == 1) {&#13;
	invokePolicy();&#13;
}&#13;
&#13;
function invokePolicy() {&#13;
	var nextFlow = '';&#13;
	var invokeApprovalWFPolicy = false;&#13;
	var policyUtil = new sn_cmp.CloudPolicyUtil();&#13;
	// Check if approval is required by invoking CloudProvisionApproval Policy&#13;
	var object = policyUtil.invokePolicy(current, "", "blueprintApproval", "provision", "blueprint", current.cat_item.blue_print + '');&#13;
	workflow.scratchpad.approvalPayload  = new global.JSON().decode(object);&#13;
	&#13;
	if(workflow.scratchpad.approvalPayload != null) {&#13;
		// If any hard error occurs while applying policies then make the activity result abort&#13;
		if(workflow.scratchpad.approvalPayload.error) {&#13;
			activity.result = 'abort';&#13;
			createCloudTrail('Apply Policy', '4', true, 'Unexpected error from policy engine.', workflow.scratchpad.approvalPayload);&#13;
		}&#13;
		if(workflow.scratchpad.approvalPayload.abortProcess) {&#13;
			activity.result = 'abort';&#13;
			createCloudTrail('Apply Policy', '4', true, 'Aborting Blueprint Request WF: ' + workflow.scratchpad.approvalPayload.message, workflow.scratchpad.approvalPayload);&#13;
		}&#13;
		// If any of the policy rules gets applied then successful is true.&#13;
		else if(workflow.scratchpad.approvalPayload.successful &amp;&amp; workflow.scratchpad.approvalPayload.approval != null) {&#13;
			//activity.result = 'success';&#13;
			var approval = {};&#13;
				approval = workflow.scratchpad.approvalPayload.approval;&#13;
				invokeApprovalWFPolicy = true;&#13;
				if(!gs.nil(workflow.scratchpad.approvalPayload.logs)) {&#13;
					var logs = new global.JSON().decode(workflow.scratchpad.approvalPayload.logs);&#13;
					current.description = logs.message + '';&#13;
					createCloudTrail('Apply Policy Rule Action', '2', true, 'Triggering approval WF: ' + logs.message, logs.rules);&#13;
				}&#13;
			}else if( !gs.nil(workflow.scratchpad.approvalPayload.workflowId)){&#13;
				invokeApprovalWFPolicy = true;&#13;
			}&#13;
			&#13;
			workflow.info(workflow.scratchpad.approvalPayload.message);&#13;
		}&#13;
		&#13;
		if(invokeApprovalWFPolicy){&#13;
			if(!gs.nil(policyUtil.getWorkflowName(workflow.scratchpad.approvalPayload.workflowId + '')))&#13;
				nextFlow = policyUtil.getWorkflowName(workflow.scratchpad.approvalPayload.workflowId + '');&#13;
			// If policy does not return approval WF then fall back to default WF&#13;
			if(nextFlow == '') {&#13;
				nextFlow = new global.WorkflowChooser().chooseWorkflowForAction('cloud_approval', current);&#13;
				if (nextFlow == '') {&#13;
					workflow.info("Approval workflow could not be found");&#13;
					gs.info( 'Apply BlueprintProvisionApproval Policy Approval workflow could not be found');&#13;
					createCloudTrail('Apply Policy', '4', true, 'Blueprint Request WF: Approval workflow could not be found', '');&#13;
					activity.result = 'abort';&#13;
				}&#13;
				else&#13;
					activity.result = 'success';&#13;
			}&#13;
			else&#13;
				activity.result = 'success';&#13;
			&#13;
			workflow.scratchpad.approvalWF = nextFlow + '';&#13;
		}&#13;
		&#13;
	}&#13;
	&#13;
	&#13;
	function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
		var catalogItemId = '' + current.cat_item;&#13;
		var requestItemId = '' + current.sys_id;&#13;
		var orderId ='';&#13;
		var contextKey = '';&#13;
		var stackId = '';&#13;
		var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
		var targetInstanceId = '';&#13;
		var userId = '' + current.request.requested_for;&#13;
		var groupId = '' + workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
		var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
	}&#13;
	&#13;
	&#13;
	</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Apply BlueprintProvisionApproval Policy">51e70e4287821300297bf4bbe3e3ec4b</activity>
        <condition>activity.result == 'abort'</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>abort</name>
        <order>2</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>59e70e4287821300297bf4bbe3e3ec4b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Apply BlueprintProvisionApproval Policy">51e70e4287821300297bf4bbe3e3ec4b</activity>
        <condition>activity.state == 'faulted'</condition>
        <condition_default/>
        <condition_type>else_flag</condition_type>
        <else_flag>true</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>skip</name>
        <order>3</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d9e70e4287821300297bf4bbe3e3ec4b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Apply BlueprintProvisionApproval Policy">51e70e4287821300297bf4bbe3e3ec4b</activity>
        <condition>activity.result == 'success'</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>success</name>
        <order>1</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e70e4287821300297bf4bbe3e3ec4b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Script">db8c65aec0a8016501d00259bc7203a4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>22</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Apply CatItemRequestEnd Policy</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage/>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d1e70e4287821300297bf4bbe3e3ec48</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>1625</x>
        <y>505</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=d1e70e4287821300297bf4bbe3e3ec48"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d1e70e4287821300297bf4bbe3e3ec48</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>55e70e4287821300297bf4bbe3e3ec48</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>activity.result = "skip";&#13;
workflow.scratchpad.postWF = '';&#13;
var policyUtil = new sn_cmp.CloudPolicyUtil();&#13;
// Invoke workflow policy with moment as pre-process&#13;
//var object = policyUtil.invokePolicy(current, "post-process", "CatalogItem", "provision", "blueprint", current.cat_item.blue_print + '');&#13;
var object = policyUtil.invokePolicy(current, "", "catalogRequestEnd", "provision", "blueprint", current.cat_item.blue_print + '');&#13;
workflow.scratchpad.postoutput  = {};&#13;
	workflow.scratchpad.postoutput = new global.JSON().decode(object);&#13;
	&#13;
	if(!gs.nil(workflow.scratchpad.postoutput)) {&#13;
		&#13;
		if(workflow.scratchpad.postoutput.error)&#13;
			activity.result = "abort";&#13;
		&#13;
		else if(workflow.scratchpad.postoutput.abortProcess) {&#13;
			activity.result = 'abort';&#13;
			workflow.info("Aborting WF: " + workflow.scratchpad.postoutput.message);&#13;
		}&#13;
		&#13;
		else if(workflow.scratchpad.postoutput.successful) {&#13;
			workflow.scratchpad.postWF = policyUtil.getWorkflowName(workflow.scratchpad.postoutput.workflowId + '');&#13;
			if(workflow.scratchpad.postWF != ''){&#13;
				activity.result = "success";&#13;
				createCloudTrail('Apply Policy Rule Action', '2', true, 'Applying catalog request end policy','');&#13;
			}&#13;
		}&#13;
	}&#13;
	function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
		var catalogItemId = '' + current.cat_item;&#13;
		var requestItemId = '' + current.sys_id;&#13;
		var orderId = '' + workflow.scratchpad.orderId;&#13;
		var contextKey = '' + workflow.scratchpad.payload.contextKey;&#13;
		var stackId = '' + current.configuration_item;&#13;
		var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
		var targetInstanceId = '' + current.configuration_item;&#13;
		var userId = '' + current.request.requested_for;&#13;
		var groupId = '' + workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
		var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
	}</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d1e70e4287821300297bf4bbe3e3ec48</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>55e70e4287821300297bf4bbe3e3ec48</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>activity.result = "skip";&#13;
workflow.scratchpad.postWF = '';&#13;
var policyUtil = new sn_cmp.CloudPolicyUtil();&#13;
// Invoke workflow policy with moment as pre-process&#13;
//var object = policyUtil.invokePolicy(current, "post-process", "CatalogItem", "provision", "blueprint", current.cat_item.blue_print + '');&#13;
var object = policyUtil.invokePolicy(current, "", "catalogRequestEnd", "provision", "blueprint", current.cat_item.blue_print + '');&#13;
workflow.scratchpad.postoutput  = {};&#13;
	workflow.scratchpad.postoutput = new global.JSON().decode(object);&#13;
	&#13;
	if(!gs.nil(workflow.scratchpad.postoutput)) {&#13;
		&#13;
		if(workflow.scratchpad.postoutput.error)&#13;
			activity.result = "abort";&#13;
		&#13;
		else if(workflow.scratchpad.postoutput.abortProcess) {&#13;
			activity.result = 'abort';&#13;
			workflow.info("Aborting WF: " + workflow.scratchpad.postoutput.message);&#13;
		}&#13;
		&#13;
		else if(workflow.scratchpad.postoutput.successful) {&#13;
			workflow.scratchpad.postWF = policyUtil.getWorkflowName(workflow.scratchpad.postoutput.workflowId + '');&#13;
			if(workflow.scratchpad.postWF != ''){&#13;
				activity.result = "success";&#13;
				createCloudTrail('Apply Policy Rule Action', '2', true, 'Applying catalog request end policy','');&#13;
			}&#13;
		}&#13;
	}&#13;
	function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
		var catalogItemId = '' + current.cat_item;&#13;
		var requestItemId = '' + current.sys_id;&#13;
		var orderId = '' + workflow.scratchpad.orderId;&#13;
		var contextKey = '' + workflow.scratchpad.payload.contextKey;&#13;
		var stackId = '' + current.configuration_item;&#13;
		var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
		var targetInstanceId = '' + current.configuration_item;&#13;
		var userId = '' + current.request.requested_for;&#13;
		var groupId = '' + workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
		var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
	}</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Apply CatItemRequestEnd Policy">d1e70e4287821300297bf4bbe3e3ec48</activity>
        <condition>activity.result == 'abort'</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>abort</name>
        <order>2</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>5de70e4287821300297bf4bbe3e3ec48</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Apply CatItemRequestEnd Policy">d1e70e4287821300297bf4bbe3e3ec48</activity>
        <condition>activity.result == 'success'</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Apply post-processing</name>
        <order>1</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>59e70e4287821300297bf4bbe3e3ec48</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Apply CatItemRequestEnd Policy">d1e70e4287821300297bf4bbe3e3ec48</activity>
        <condition>true</condition>
        <condition_default/>
        <condition_type>else_flag</condition_type>
        <else_flag>true</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>skip</name>
        <order>3</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d9e70e4287821300297bf4bbe3e3ec48</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Script">db8c65aec0a8016501d00259bc7203a4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>20</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Apply CatItemRequestStart Policy</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage/>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>19e74e4287821300297bf4bbe3e3ec29</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>27</x>
        <y>173</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=19e74e4287821300297bf4bbe3e3ec29"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>19e74e4287821300297bf4bbe3e3ec29</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>99e74e4287821300297bf4bbe3e3ec29</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// Activity result = success - 1. When policy is executed successfully and workflow is found&#13;
// Activity result = failure/skip - 1. When policy is executed successfully and workflow is not found 2. Policy does not exist&#13;
// Activity result = abort - 1. When policy returns abort action 2. when there is any hard error in exceuting policy&#13;
&#13;
CMPUtil.updateRequestItemComments(current.sys_id, "Provisioning Started"); &#13;
								  &#13;
//var link =  "Provisioning Started. Request Details " + "?id=cloud_activities&amp;category=cloud_activities&amp;sub_category=request&amp;active_tab=requestDetails&amp;spa=1&amp;sys_id="+current.sys_id+"&amp;selected_card="+current.sys_id;&#13;
&#13;
/**** Initialize Data ****/&#13;
// Set order submission count to 1 and increase it every time the same order is resubmitted&#13;
// Set error flags &#13;
workflow.scratchpad.submitCount = 1;&#13;
workflow.scratchpad.operatorFlag = false;&#13;
/*workflow.scratchpad.beforeBPOErrorFlag = false;&#13;
workflow.scratchpad.afterBPOErrorFlag = false;&#13;
&#13;
workflow.scratchpad.beforeBPOSubmitCount = 1;&#13;
workflow.scratchpad.afterBPOSubmitCount = 1;*/&#13;
&#13;
workflow.scratchpad.taskErrorMessage = '';&#13;
current.variables.cloudTaskWorkflowInput = {};&#13;
// Set WF name for Task processing here&#13;
workflow.scratchpad.taskWFName = new global.WorkflowChooser().chooseWorkflowForAction('cloud_task_processing', current);&#13;
&#13;
/**** Initialize Data Ends ****/&#13;
&#13;
/**** Invoke CatalogRequestStart Policy ****/&#13;
activity.result = "skip";&#13;
workflow.scratchpad.preWF = '';&#13;
var policyUtil = new sn_cmp.CloudPolicyUtil();&#13;
&#13;
// Generate order JSON. &#13;
workflow.scratchpad.payload = generateOrderJSON();&#13;
&#13;
// Invoke workflow policy with moment as pre-process&#13;
var object = policyUtil.invokePolicy(current, "", "catalogRequestStart", "Provision", "Blueprint", current.cat_item.blue_print + '');&#13;
workflow.scratchpad.output  = {};&#13;
	workflow.scratchpad.output = new global.JSON().decode(object);&#13;
	&#13;
	if(workflow.scratchpad.output != null) {&#13;
		if(workflow.scratchpad.output.error){&#13;
			activity.result = "abort";&#13;
			createCloudTrail('Invoke Pre-Process Workflow', '4', true, 'Unexpected error from policy engine.', output.logs);&#13;
		}&#13;
		&#13;
		else if(workflow.scratchpad.output.abortProcess) {&#13;
			activity.result = "abort";&#13;
			workflow.info("Aborting WF: " + workflow.scratchpad.output.message);&#13;
			createCloudTrail('Invoke Pre-Process Workflow', '4', true, 'Aborting Blueprint Request WF: ' + output.message, '');&#13;
		}&#13;
		&#13;
		else if(workflow.scratchpad.output.successful) {&#13;
			workflow.scratchpad.preWF = policyUtil.getWorkflowName(workflow.scratchpad.output.workflowId + '');&#13;
			if(workflow.scratchpad.preWF != ''){&#13;
				activity.result = "success";&#13;
				createCloudTrail('Invoke Pre-Process Workflow', '2', true, 'Applying catalog request start policy. Triggering pre-process WF.', workflow.scratchpad.output);&#13;
			}&#13;
		}&#13;
	}&#13;
&#13;
function generateOrderJSON(){&#13;
	var result = {};&#13;
		result.userId = ''+current.request.requested_for;&#13;
		result.requestItem = current.sys_id + '';&#13;
		result.blueprint = current.cat_item.blue_print.name + '';&#13;
		result.operationName = "Provision";&#13;
		result.contextKey = "";&#13;
		result.contextObj = "";&#13;
		result.entityType = "Blueprint";&#13;
		result.status = "Initialized";&#13;
		var date = new GlideDateTime();&#13;
		result.orderDate = date.getValue();&#13;
		&#13;
		result.orderFormData = policyUtil.setOrderFormData(current);&#13;
		return result;&#13;
	}&#13;
	&#13;
	&#13;
	function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
		var catalogItemId = '' + current.cat_item;&#13;
		var requestItemId = '' + current.sys_id;&#13;
		var orderId ='';&#13;
		var contextKey = '';&#13;
		var stackId = '';&#13;
		var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
		var targetInstanceId = '';&#13;
		var userId = '' + current.request.requested_for;&#13;
		var groupId = '' + workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
		var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
	}&#13;
</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>19e74e4287821300297bf4bbe3e3ec29</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>99e74e4287821300297bf4bbe3e3ec29</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// Activity result = success - 1. When policy is executed successfully and workflow is found&#13;
// Activity result = failure/skip - 1. When policy is executed successfully and workflow is not found 2. Policy does not exist&#13;
// Activity result = abort - 1. When policy returns abort action 2. when there is any hard error in exceuting policy&#13;
&#13;
CMPUtil.updateRequestItemComments(current.sys_id, "Provisioning Started"); &#13;
								  &#13;
//var link =  "Provisioning Started. Request Details " + "?id=cloud_activities&amp;category=cloud_activities&amp;sub_category=request&amp;active_tab=requestDetails&amp;spa=1&amp;sys_id="+current.sys_id+"&amp;selected_card="+current.sys_id;&#13;
&#13;
/**** Initialize Data ****/&#13;
// Set order submission count to 1 and increase it every time the same order is resubmitted&#13;
// Set error flags &#13;
workflow.scratchpad.submitCount = 1;&#13;
workflow.scratchpad.operatorFlag = false;&#13;
/*workflow.scratchpad.beforeBPOErrorFlag = false;&#13;
workflow.scratchpad.afterBPOErrorFlag = false;&#13;
&#13;
workflow.scratchpad.beforeBPOSubmitCount = 1;&#13;
workflow.scratchpad.afterBPOSubmitCount = 1;*/&#13;
&#13;
workflow.scratchpad.taskErrorMessage = '';&#13;
current.variables.cloudTaskWorkflowInput = {};&#13;
// Set WF name for Task processing here&#13;
workflow.scratchpad.taskWFName = new global.WorkflowChooser().chooseWorkflowForAction('cloud_task_processing', current);&#13;
&#13;
/**** Initialize Data Ends ****/&#13;
&#13;
/**** Invoke CatalogRequestStart Policy ****/&#13;
activity.result = "skip";&#13;
workflow.scratchpad.preWF = '';&#13;
var policyUtil = new sn_cmp.CloudPolicyUtil();&#13;
&#13;
// Generate order JSON. &#13;
workflow.scratchpad.payload = generateOrderJSON();&#13;
&#13;
// Invoke workflow policy with moment as pre-process&#13;
var object = policyUtil.invokePolicy(current, "", "catalogRequestStart", "Provision", "Blueprint", current.cat_item.blue_print + '');&#13;
workflow.scratchpad.output  = {};&#13;
	workflow.scratchpad.output = new global.JSON().decode(object);&#13;
	&#13;
	if(workflow.scratchpad.output != null) {&#13;
		if(workflow.scratchpad.output.error){&#13;
			activity.result = "abort";&#13;
			createCloudTrail('Invoke Pre-Process Workflow', '4', true, 'Unexpected error from policy engine.', output.logs);&#13;
		}&#13;
		&#13;
		else if(workflow.scratchpad.output.abortProcess) {&#13;
			activity.result = "abort";&#13;
			workflow.info("Aborting WF: " + workflow.scratchpad.output.message);&#13;
			createCloudTrail('Invoke Pre-Process Workflow', '4', true, 'Aborting Blueprint Request WF: ' + output.message, '');&#13;
		}&#13;
		&#13;
		else if(workflow.scratchpad.output.successful) {&#13;
			workflow.scratchpad.preWF = policyUtil.getWorkflowName(workflow.scratchpad.output.workflowId + '');&#13;
			if(workflow.scratchpad.preWF != ''){&#13;
				activity.result = "success";&#13;
				createCloudTrail('Invoke Pre-Process Workflow', '2', true, 'Applying catalog request start policy. Triggering pre-process WF.', workflow.scratchpad.output);&#13;
			}&#13;
		}&#13;
	}&#13;
&#13;
function generateOrderJSON(){&#13;
	var result = {};&#13;
		result.userId = ''+current.request.requested_for;&#13;
		result.requestItem = current.sys_id + '';&#13;
		result.blueprint = current.cat_item.blue_print.name + '';&#13;
		result.operationName = "Provision";&#13;
		result.contextKey = "";&#13;
		result.contextObj = "";&#13;
		result.entityType = "Blueprint";&#13;
		result.status = "Initialized";&#13;
		var date = new GlideDateTime();&#13;
		result.orderDate = date.getValue();&#13;
		&#13;
		result.orderFormData = policyUtil.setOrderFormData(current);&#13;
		return result;&#13;
	}&#13;
	&#13;
	&#13;
	function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
		var catalogItemId = '' + current.cat_item;&#13;
		var requestItemId = '' + current.sys_id;&#13;
		var orderId ='';&#13;
		var contextKey = '';&#13;
		var stackId = '';&#13;
		var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
		var targetInstanceId = '';&#13;
		var userId = '' + current.request.requested_for;&#13;
		var groupId = '' + workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
		var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
	}&#13;
</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Apply CatItemRequestStart Policy">19e74e4287821300297bf4bbe3e3ec29</activity>
        <condition>activity.result == 'abort'</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>abort</name>
        <order>2</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>11e74e4287821300297bf4bbe3e3ec2a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Apply CatItemRequestStart Policy">19e74e4287821300297bf4bbe3e3ec29</activity>
        <condition>activity.result == 'success'</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Apply pre-processing</name>
        <order>1</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>91e74e4287821300297bf4bbe3e3ec2a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Apply CatItemRequestStart Policy">19e74e4287821300297bf4bbe3e3ec29</activity>
        <condition/>
        <condition_default/>
        <condition_type>else_flag</condition_type>
        <else_flag>true</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>skip </name>
        <order>3</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>9de74e4287821300297bf4bbe3e3ec29</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Begin">c7a5e32c0a0a0b3a002377c24ed8ea76</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>1</databus_lookup_id>
        <height/>
        <input/>
        <is_parent>false</is_parent>
        <name>Begin</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage/>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>91e74e4287821300297bf4bbe3e3ec36</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width>80</width>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>37</x>
        <y>0</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=91e74e4287821300297bf4bbe3e3ec36"/>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Begin">91e74e4287821300297bf4bbe3e3ec36</activity>
        <condition>true</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>true</is_positive>
        <name>Always</name>
        <order>0</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>59e74e4287821300297bf4bbe3e3ec36</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Script">db8c65aec0a8016501d00259bc7203a4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>26</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Capacity Check Failed</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage display_value="Capacity Check Failed">c9e70e4287821300297bf4bbe3e3ec45</stage>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d9e74e4287821300297bf4bbe3e3ec27</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>256</x>
        <y>794</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=d9e74e4287821300297bf4bbe3e3ec27"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d9e74e4287821300297bf4bbe3e3ec27</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>5de74e4287821300297bf4bbe3e3ec27</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// Set error flag for task creation&#13;
//workflow.scratchpad.beforeBPOErrorFlag = true;&#13;
CMPUtil.updateRequestItemComments(current.sys_id, "Capacity Check Failed");&#13;
&#13;
createCloudTrail('Check Datacenter Capacity', '4', true, 'Datacenter capacity exceeded', '');&#13;
&#13;
function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
	var catalogItemId = '' + current.cat_item;&#13;
	var requestItemId = '' + current.sys_id;&#13;
	var orderId ='';&#13;
	var contextKey = '';&#13;
	var stackId = '';&#13;
	var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
	var targetInstanceId = '';&#13;
	var userId = '' + current.request.requested_for;&#13;
	var groupId = '' + 	workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
	var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
}</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d9e74e4287821300297bf4bbe3e3ec27</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>5de74e4287821300297bf4bbe3e3ec27</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// Set error flag for task creation&#13;
//workflow.scratchpad.beforeBPOErrorFlag = true;&#13;
CMPUtil.updateRequestItemComments(current.sys_id, "Capacity Check Failed");&#13;
&#13;
createCloudTrail('Check Datacenter Capacity', '4', true, 'Datacenter capacity exceeded', '');&#13;
&#13;
function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
	var catalogItemId = '' + current.cat_item;&#13;
	var requestItemId = '' + current.sys_id;&#13;
	var orderId ='';&#13;
	var contextKey = '';&#13;
	var stackId = '';&#13;
	var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
	var targetInstanceId = '';&#13;
	var userId = '' + current.request.requested_for;&#13;
	var groupId = '' + 	workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
	var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
}</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Capacity Check Failed">d9e74e4287821300297bf4bbe3e3ec27</activity>
        <condition>true</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>true</is_positive>
        <name>Always</name>
        <order>0</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>51e74e4287821300297bf4bbe3e3ec28</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Script">db8c65aec0a8016501d00259bc7203a4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>10</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Check Quota</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage/>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>dde70e4287821300297bf4bbe3e3ec49</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>33</x>
        <y>657</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=dde70e4287821300297bf4bbe3e3ec49"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>dde70e4287821300297bf4bbe3e3ec49</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>51e70e4287821300297bf4bbe3e3ec4a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// TODO: in case of failure, iterate through result to get&#13;
// details of which quota(s) limit exceeded.&#13;
// Result format should be {'Status':&lt;value&gt;, '&lt;resource_id1':&lt;msg&gt;, ...}&#13;
	&#13;
	var result = checkQuota(workflow.scratchpad.payload);&#13;
	if(result.quotaStatus &amp;&amp; result.capacityStatus)&#13;
		activity.result = 'success';&#13;
	else if(!result.capacityStatus)&#13;
		activity.result = 'capacity_fail';&#13;
	else&#13;
		activity.result = 'quota_fail';&#13;
&#13;
    if(activity.result != 'success') {&#13;
		workflow.scratchpad.taskErrorMessage = '' + result.message;&#13;
	}&#13;
	&#13;
	function checkQuota(orderForm) {&#13;
		var userId = '' + current.request.requested_for;&#13;
		var groupId = orderForm.orderFormData.UserGroup;&#13;
		var bpName = current.cat_item.blue_print.name + '';&#13;
		var quotaSvc = new sn_cmp_api.QuotaServiceScript();&#13;
		var ret = quotaSvc.checkQuotaForBlueprintResources(groupId, userId, bpName,&#13;
		new global.JSON().encode(orderForm.orderFormData), '' + current.sys_id);&#13;
		return new global.JSON().decode(ret);&#13;
	}&#13;
</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>dde70e4287821300297bf4bbe3e3ec49</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>51e70e4287821300297bf4bbe3e3ec4a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// TODO: in case of failure, iterate through result to get&#13;
// details of which quota(s) limit exceeded.&#13;
// Result format should be {'Status':&lt;value&gt;, '&lt;resource_id1':&lt;msg&gt;, ...}&#13;
	&#13;
	var result = checkQuota(workflow.scratchpad.payload);&#13;
	if(result.quotaStatus &amp;&amp; result.capacityStatus)&#13;
		activity.result = 'success';&#13;
	else if(!result.capacityStatus)&#13;
		activity.result = 'capacity_fail';&#13;
	else&#13;
		activity.result = 'quota_fail';&#13;
&#13;
    if(activity.result != 'success') {&#13;
		workflow.scratchpad.taskErrorMessage = '' + result.message;&#13;
	}&#13;
	&#13;
	function checkQuota(orderForm) {&#13;
		var userId = '' + current.request.requested_for;&#13;
		var groupId = orderForm.orderFormData.UserGroup;&#13;
		var bpName = current.cat_item.blue_print.name + '';&#13;
		var quotaSvc = new sn_cmp_api.QuotaServiceScript();&#13;
		var ret = quotaSvc.checkQuotaForBlueprintResources(groupId, userId, bpName,&#13;
		new global.JSON().encode(orderForm.orderFormData), '' + current.sys_id);&#13;
		return new global.JSON().decode(ret);&#13;
	}&#13;
</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Check Quota">dde70e4287821300297bf4bbe3e3ec49</activity>
        <condition>activity.state == 'faulted'</condition>
        <condition_default/>
        <condition_type>else_flag</condition_type>
        <else_flag>true</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Error</name>
        <order>4</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>59e70e4287821300297bf4bbe3e3ec4a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Check Quota">dde70e4287821300297bf4bbe3e3ec49</activity>
        <condition>activity.result == 'capacity_fail' &amp;&amp; activity.state != 'faulted'</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>on capacity check failure</name>
        <order>3</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d9e70e4287821300297bf4bbe3e3ec4a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Check Quota">dde70e4287821300297bf4bbe3e3ec49</activity>
        <condition>activity.result == 'quota_fail' &amp;&amp; activity.state != 'faulted'</condition>
        <condition_default/>
        <condition_type>else_flag</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>on quota check failure</name>
        <order>2</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>55e70e4287821300297bf4bbe3e3ec4a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Check Quota">dde70e4287821300297bf4bbe3e3ec49</activity>
        <condition>activity.result == 'success' &amp;&amp; activity.state != 'faulted'</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Success</name>
        <order>1</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e70e4287821300297bf4bbe3e3ec4a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Script">db8c65aec0a8016501d00259bc7203a4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>17</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Cloud Request Approved</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage display_value="Cloud Request Approved">c5e70e4287821300297bf4bbe3e3ec45</stage>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>1de74e4287821300297bf4bbe3e3ec2b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>820</x>
        <y>2</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=1de74e4287821300297bf4bbe3e3ec2b"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>1de74e4287821300297bf4bbe3e3ec2b</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>9de74e4287821300297bf4bbe3e3ec2b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>CMPUtil.updateRequestItemComments(current.sys_id, "Cloud Request Approved");&#13;
</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>1de74e4287821300297bf4bbe3e3ec2b</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>9de74e4287821300297bf4bbe3e3ec2b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>CMPUtil.updateRequestItemComments(current.sys_id, "Cloud Request Approved");&#13;
</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Cloud Request Approved">1de74e4287821300297bf4bbe3e3ec2b</activity>
        <condition>true</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>true</is_positive>
        <name>Always</name>
        <order>0</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>91e74e4287821300297bf4bbe3e3ec2c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Script">db8c65aec0a8016501d00259bc7203a4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>37</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Cloud Request Approved</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage display_value="Cloud Request Approved">c5e70e4287821300297bf4bbe3e3ec45</stage>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d1e74e4287821300297bf4bbe3e3ec38</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>555</x>
        <y>25</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=d1e74e4287821300297bf4bbe3e3ec38"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d1e74e4287821300297bf4bbe3e3ec38</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>55e74e4287821300297bf4bbe3e3ec38</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>CMPUtil.updateRequestItemComments(current.sys_id, "Cloud Request Approved");&#13;
</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d1e74e4287821300297bf4bbe3e3ec38</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>55e74e4287821300297bf4bbe3e3ec38</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>CMPUtil.updateRequestItemComments(current.sys_id, "Cloud Request Approved");&#13;
</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Cloud Request Approved">d1e74e4287821300297bf4bbe3e3ec38</activity>
        <condition>true</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>true</is_positive>
        <name>Always</name>
        <order>0</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>59e74e4287821300297bf4bbe3e3ec38</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Script">db8c65aec0a8016501d00259bc7203a4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>18</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Cloud request rejected</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage display_value="Cloud Request Rejected">4de70e4287821300297bf4bbe3e3ec45</stage>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d9e74e4287821300297bf4bbe3e3ec24</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>575</x>
        <y>695</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=d9e74e4287821300297bf4bbe3e3ec24"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d9e74e4287821300297bf4bbe3e3ec24</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>5de74e4287821300297bf4bbe3e3ec24</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>CMPUtil.updateRequestItemComments(current.sys_id, "Cloud Request Rejected");&#13;
</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d9e74e4287821300297bf4bbe3e3ec24</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>5de74e4287821300297bf4bbe3e3ec24</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>CMPUtil.updateRequestItemComments(current.sys_id, "Cloud Request Rejected");&#13;
</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Cloud request rejected">d9e74e4287821300297bf4bbe3e3ec24</activity>
        <condition>true</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>true</is_positive>
        <name>Always</name>
        <order>0</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>51e74e4287821300297bf4bbe3e3ec25</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Script">db8c65aec0a8016501d00259bc7203a4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>6</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Deployment Failed</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage display_value="Deployment Failed">cde70e4287821300297bf4bbe3e3ec45</stage>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d1e70e4287821300297bf4bbe3e3ec49</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>1059</x>
        <y>773</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=d1e70e4287821300297bf4bbe3e3ec49"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d1e70e4287821300297bf4bbe3e3ec49</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>55e70e4287821300297bf4bbe3e3ec49</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// Close request and requested item&#13;
current.setValue('state','4'); //Closed Incomplete&#13;
var grR = new GlideRecord('sc_request'); // close the request&#13;
grR.get(current.request + '');&#13;
grR.setValue('request_state', 'closed_incomplete');&#13;
grR.setValue('stage', 'closed_incomplete');&#13;
grR.update();&#13;
CMPUtil.updateRequestItemComments(current.sys_id, "Deployment Failed");&#13;
workflow.info(workflow.scratchpad.error);&#13;
workflow.scratchpad.orderevent = current.sys_id + 'order';&#13;
&#13;
// Call clean up only when blueprint orchestration fails&#13;
if(!gs.nil(workflow.scratchpad.orderId)) {&#13;
	cleanup();&#13;
}&#13;
&#13;
createCloudTrail('Complete Cloud Orchestration', '4', true, 'Blueprint deployment failed', workflow.scratchpad.error);&#13;
&#13;
function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
	var catalogItemId = '' + current.cat_item;&#13;
	var requestItemId = '' + current.sys_id;&#13;
	var orderId = '' + workflow.scratchpad.orderId;&#13;
	var contextKey = '' + workflow.scratchpad.payload.contextKey;&#13;
	var stackId = '' + current.configuration_item;&#13;
	var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
	var targetInstanceId = '' + current.configuration_item;&#13;
	var userId = '' + current.request.requested_for;&#13;
	var groupId = '' + workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
	var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
}&#13;
&#13;
function cleanup() {&#13;
	// Perform clean up&#13;
	workflow.scratchpad.payload.operationName = 'Cleanup';&#13;
	workflow.scratchpad.payload.stack = '' + current.configuration_item;&#13;
&#13;
	try {&#13;
		var os= new sn_cmp_api.OrderServiceScript();&#13;
		var order = os.submitOrder(new global.JSON().encode(workflow.scratchpad.payload));&#13;
		var orderObj = new global.JSON().decode(order);&#13;
	} catch (e) {&#13;
		// NO-OP&#13;
		createCloudTrail('Complete Cloud Orchestration', '4', false, 'Exception while cleaning up', e);&#13;
	}&#13;
}</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d1e70e4287821300297bf4bbe3e3ec49</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>55e70e4287821300297bf4bbe3e3ec49</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// Close request and requested item&#13;
current.setValue('state','4'); //Closed Incomplete&#13;
var grR = new GlideRecord('sc_request'); // close the request&#13;
grR.get(current.request + '');&#13;
grR.setValue('request_state', 'closed_incomplete');&#13;
grR.setValue('stage', 'closed_incomplete');&#13;
grR.update();&#13;
CMPUtil.updateRequestItemComments(current.sys_id, "Deployment Failed");&#13;
workflow.info(workflow.scratchpad.error);&#13;
workflow.scratchpad.orderevent = current.sys_id + 'order';&#13;
&#13;
// Call clean up only when blueprint orchestration fails&#13;
if(!gs.nil(workflow.scratchpad.orderId)) {&#13;
	cleanup();&#13;
}&#13;
&#13;
createCloudTrail('Complete Cloud Orchestration', '4', true, 'Blueprint deployment failed', workflow.scratchpad.error);&#13;
&#13;
function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
	var catalogItemId = '' + current.cat_item;&#13;
	var requestItemId = '' + current.sys_id;&#13;
	var orderId = '' + workflow.scratchpad.orderId;&#13;
	var contextKey = '' + workflow.scratchpad.payload.contextKey;&#13;
	var stackId = '' + current.configuration_item;&#13;
	var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
	var targetInstanceId = '' + current.configuration_item;&#13;
	var userId = '' + current.request.requested_for;&#13;
	var groupId = '' + workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
	var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
}&#13;
&#13;
function cleanup() {&#13;
	// Perform clean up&#13;
	workflow.scratchpad.payload.operationName = 'Cleanup';&#13;
	workflow.scratchpad.payload.stack = '' + current.configuration_item;&#13;
&#13;
	try {&#13;
		var os= new sn_cmp_api.OrderServiceScript();&#13;
		var order = os.submitOrder(new global.JSON().encode(workflow.scratchpad.payload));&#13;
		var orderObj = new global.JSON().decode(order);&#13;
	} catch (e) {&#13;
		// NO-OP&#13;
		createCloudTrail('Complete Cloud Orchestration', '4', false, 'Exception while cleaning up', e);&#13;
	}&#13;
}</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Deployment Failed">d1e70e4287821300297bf4bbe3e3ec49</activity>
        <condition>true</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>true</is_positive>
        <name>Always</name>
        <order>0</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>59e70e4287821300297bf4bbe3e3ec49</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Script">db8c65aec0a8016501d00259bc7203a4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>5</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>done?</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage display_value="Deploying Stack">41e70e4287821300297bf4bbe3e3ec44</stage>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e74e4287821300297bf4bbe3e3ec25</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>1071</x>
        <y>165</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=d5e74e4287821300297bf4bbe3e3ec25"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d5e74e4287821300297bf4bbe3e3ec25</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>59e74e4287821300297bf4bbe3e3ec25</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>var gr = new GlideRecord('sn_cmp_order');&#13;
workflow.scratchpad.error = '';&#13;
if (!gr.get(workflow.scratchpad.orderId)) {&#13;
	workflow.scratchpad.error = 'Cannot find order: '&#13;
	+ workflow.scratchpad.orderId;&#13;
	activity.result = 'failure';&#13;
} else {&#13;
	current.configuration_item = gr.stack + '';&#13;
	workflow.scratchpad.stackId = gr.stack + '';&#13;
	//workflow.scratchpad.payload.stackId = gr.stack + '';&#13;
	workflow.scratchpad.payload.contextKey = gr.context_key + '';&#13;
	if (gr.status == '7') { // Completed&#13;
		activity.result = 'success';&#13;
	} else if (gr.status == '8') { // Error&#13;
		activity.result = 'failure';&#13;
		workflow.scratchpad.error = 'Failed creating stack';&#13;
	} else { // not done yet&#13;
		activity.result = 'continue';&#13;
	}&#13;
}&#13;
&#13;
// Set error flag for task creation&#13;
if(activity.result == 'failure') {&#13;
//	workflow.scratchpad.afterBPOErrorFlag = true;&#13;
}</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d5e74e4287821300297bf4bbe3e3ec25</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>59e74e4287821300297bf4bbe3e3ec25</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>var gr = new GlideRecord('sn_cmp_order');&#13;
workflow.scratchpad.error = '';&#13;
if (!gr.get(workflow.scratchpad.orderId)) {&#13;
	workflow.scratchpad.error = 'Cannot find order: '&#13;
	+ workflow.scratchpad.orderId;&#13;
	activity.result = 'failure';&#13;
} else {&#13;
	current.configuration_item = gr.stack + '';&#13;
	workflow.scratchpad.stackId = gr.stack + '';&#13;
	//workflow.scratchpad.payload.stackId = gr.stack + '';&#13;
	workflow.scratchpad.payload.contextKey = gr.context_key + '';&#13;
	if (gr.status == '7') { // Completed&#13;
		activity.result = 'success';&#13;
	} else if (gr.status == '8') { // Error&#13;
		activity.result = 'failure';&#13;
		workflow.scratchpad.error = 'Failed creating stack';&#13;
	} else { // not done yet&#13;
		activity.result = 'continue';&#13;
	}&#13;
}&#13;
&#13;
// Set error flag for task creation&#13;
if(activity.result == 'failure') {&#13;
//	workflow.scratchpad.afterBPOErrorFlag = true;&#13;
}</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="done?">d5e74e4287821300297bf4bbe3e3ec25</activity>
        <condition>activity.result=='failure';</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Failure</name>
        <order>2</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>dde74e4287821300297bf4bbe3e3ec25</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="done?">d5e74e4287821300297bf4bbe3e3ec25</activity>
        <condition/>
        <condition_default/>
        <condition_type>else_flag</condition_type>
        <else_flag>true</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Retry</name>
        <order>3</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>5de74e4287821300297bf4bbe3e3ec25</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="done?">d5e74e4287821300297bf4bbe3e3ec25</activity>
        <condition>activity.result=='success';</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Success</name>
        <order>1</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>51e74e4287821300297bf4bbe3e3ec26</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="End">c7a66f7d0a0a0b3a004544a6d2f14076</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>2</databus_lookup_id>
        <height/>
        <input/>
        <is_parent>false</is_parent>
        <name>End</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage/>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d1e74e4287821300297bf4bbe3e3ec31</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width>80</width>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>1644</x>
        <y>783</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=d1e74e4287821300297bf4bbe3e3ec31"/>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Script">db8c65aec0a8016501d00259bc7203a4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>3</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Execute Cloud Orchestration Service</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage display_value="Deploying Stack">41e70e4287821300297bf4bbe3e3ec44</stage>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>59e74e4287821300297bf4bbe3e3ec33</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>572</x>
        <y>506</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=59e74e4287821300297bf4bbe3e3ec33"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>59e74e4287821300297bf4bbe3e3ec33</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d9e74e4287821300297bf4bbe3e3ec33</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>workflow.scratchpad.orderevent = current.sys_id + 'order';&#13;
&#13;
workflow.scratchpad.orderId = '';&#13;
&#13;
var os = new sn_cmp_api.OrderServiceScript();&#13;
&#13;
var order = os.submitOrder(new global.JSON().encode(workflow.scratchpad.payload));&#13;
workflow.info(order);&#13;
var orderObj = new global.JSON().decode(order);&#13;
workflow.scratchpad.orderId = orderObj.id;&#13;
CMPUtil.updateRequestItemComments(current.sys_id, "Order Submitted - Deployement Started");&#13;
&#13;
createCloudTrail('Complete Cloud Orchestration', '2', false, 'Order submitted', order);&#13;
&#13;
function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
	var catalogItemId = '' + current.cat_item;&#13;
	var requestItemId = '' + current.sys_id;&#13;
	var orderId = '' + workflow.scratchpad.orderId;&#13;
	var contextKey = '';&#13;
	var stackId = '';&#13;
	var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
	var targetInstanceId = '';&#13;
	var userId = '' + current.request.requested_for;&#13;
	var groupId = '' + workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
	var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
}&#13;
</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>59e74e4287821300297bf4bbe3e3ec33</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d9e74e4287821300297bf4bbe3e3ec33</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>workflow.scratchpad.orderevent = current.sys_id + 'order';&#13;
&#13;
workflow.scratchpad.orderId = '';&#13;
&#13;
var os = new sn_cmp_api.OrderServiceScript();&#13;
&#13;
var order = os.submitOrder(new global.JSON().encode(workflow.scratchpad.payload));&#13;
workflow.info(order);&#13;
var orderObj = new global.JSON().decode(order);&#13;
workflow.scratchpad.orderId = orderObj.id;&#13;
CMPUtil.updateRequestItemComments(current.sys_id, "Order Submitted - Deployement Started");&#13;
&#13;
createCloudTrail('Complete Cloud Orchestration', '2', false, 'Order submitted', order);&#13;
&#13;
function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
	var catalogItemId = '' + current.cat_item;&#13;
	var requestItemId = '' + current.sys_id;&#13;
	var orderId = '' + workflow.scratchpad.orderId;&#13;
	var contextKey = '';&#13;
	var stackId = '';&#13;
	var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
	var targetInstanceId = '';&#13;
	var userId = '' + current.request.requested_for;&#13;
	var groupId = '' + workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
	var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
}&#13;
</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Execute Cloud Orchestration Service">59e74e4287821300297bf4bbe3e3ec33</activity>
        <condition>true</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>true</is_positive>
        <name>Always</name>
        <order>0</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>dde74e4287821300297bf4bbe3e3ec33</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="If">98f621ca0a0a0b5900f7c291f5e45a0e</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>16</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Is cloud request approved?</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage/>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>dde74e4287821300297bf4bbe3e3ec31</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>253</x>
        <y>41</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=dde74e4287821300297bf4bbe3e3ec31"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>dde74e4287821300297bf4bbe3e3ec31</document_key>
        <order>300</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>59e74e4287821300297bf4bbe3e3ec32</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// This script needs to set answer to 'yes' or 'no' to indicate the state of the activity.&#13;
			//&#13;
			// For example,&#13;
			//&#13;
			//   answer = ifScript();&#13;
			//&#13;
			//   function ifScript() {&#13;
			//      if (condition is true) {&#13;
			//         return 'yes';&#13;
			//      }&#13;
			//      return 'no';&#13;
			//   }&#13;
			&#13;
			answer = ifScript();&#13;
			&#13;
			function ifScript() {&#13;
			if(!gs.nil(workflow.scratchpad.approvalResult)) {&#13;
			if(workflow.scratchpad.approvalResult + '' == 'approved')&#13;
			return 'yes';&#13;
			else if(workflow.scratchpad.approvalResult + '' == 'rejected')&#13;
			return 'no';&#13;
			else&#13;
			return 'error';&#13;
			}&#13;
			else &#13;
			return 'error';&#13;
			}</value>
        <variable display_value="">c35e50810a0a0ba96248a709b450fc32</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>dde74e4287821300297bf4bbe3e3ec31</document_key>
        <order>200</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>95e74e4287821300297bf4bbe3e3ec32</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>1</value>
        <variable display_value="">493d2c1d0a6a803f3217a75738ea3289</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>dde74e4287821300297bf4bbe3e3ec31</document_key>
        <order>100</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d1e74e4287821300297bf4bbe3e3ec32</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">493cba6a0a6a803f07df24b118473551</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>dde74e4287821300297bf4bbe3e3ec31</document_key>
        <order>100</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d1e74e4287821300297bf4bbe3e3ec32</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">493cba6a0a6a803f07df24b118473551</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>dde74e4287821300297bf4bbe3e3ec31</document_key>
        <order>200</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>95e74e4287821300297bf4bbe3e3ec32</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>1</value>
        <variable display_value="">493d2c1d0a6a803f3217a75738ea3289</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>dde74e4287821300297bf4bbe3e3ec31</document_key>
        <order>300</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>59e74e4287821300297bf4bbe3e3ec32</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// This script needs to set answer to 'yes' or 'no' to indicate the state of the activity.&#13;
			//&#13;
			// For example,&#13;
			//&#13;
			//   answer = ifScript();&#13;
			//&#13;
			//   function ifScript() {&#13;
			//      if (condition is true) {&#13;
			//         return 'yes';&#13;
			//      }&#13;
			//      return 'no';&#13;
			//   }&#13;
			&#13;
			answer = ifScript();&#13;
			&#13;
			function ifScript() {&#13;
			if(!gs.nil(workflow.scratchpad.approvalResult)) {&#13;
			if(workflow.scratchpad.approvalResult + '' == 'approved')&#13;
			return 'yes';&#13;
			else if(workflow.scratchpad.approvalResult + '' == 'rejected')&#13;
			return 'no';&#13;
			else&#13;
			return 'error';&#13;
			}&#13;
			else &#13;
			return 'error';&#13;
			}</value>
        <variable display_value="">c35e50810a0a0ba96248a709b450fc32</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Is cloud request approved?">dde74e4287821300297bf4bbe3e3ec31</activity>
        <condition/>
        <condition_default/>
        <condition_type>else_flag</condition_type>
        <else_flag>true</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>error</name>
        <order>201</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d1e74e4287821300297bf4bbe3e3ec33</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Is cloud request approved?">dde74e4287821300297bf4bbe3e3ec31</activity>
        <condition>activity.result == 'no'</condition>
        <condition_default display_value="No">c1eff6430a0a0b59000f955abe842c94</condition_default>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>No</name>
        <order>200</order>
        <short_description/>
        <skip_during_generate>true</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>dde74e4287821300297bf4bbe3e3ec32</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Is cloud request approved?">dde74e4287821300297bf4bbe3e3ec31</activity>
        <condition>activity.result == 'yes'</condition>
        <condition_default display_value="Yes">c1ef63200a0a0b59005ef89bae78feb7</condition_default>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>true</is_positive>
        <name>Yes</name>
        <order>100</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>51e74e4287821300297bf4bbe3e3ec33</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="If">98f621ca0a0a0b5900f7c291f5e45a0e</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>31</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>New Order?</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage/>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>dde74e4287821300297bf4bbe3e3ec36</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>575</x>
        <y>400</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=dde74e4287821300297bf4bbe3e3ec36"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>dde74e4287821300297bf4bbe3e3ec36</document_key>
        <order>200</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>15e74e4287821300297bf4bbe3e3ec37</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>1</value>
        <variable display_value="">493d2c1d0a6a803f3217a75738ea3289</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>dde74e4287821300297bf4bbe3e3ec36</document_key>
        <order>100</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>51e74e4287821300297bf4bbe3e3ec37</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">493cba6a0a6a803f07df24b118473551</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>dde74e4287821300297bf4bbe3e3ec36</document_key>
        <order>300</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e74e4287821300297bf4bbe3e3ec37</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// This script needs to set answer to 'yes' or 'no' to indicate the state of the activity.&#13;
//&#13;
&#13;
   answer = ifScript();&#13;
&#13;
   function ifScript() {&#13;
	   // Decide whether to create new order or re-submit old one&#13;
	   // In case of beforeBPO failures orderID will not be generated since the task is getting created directly.&#13;
	   // Hence check for orderId as well&#13;
      if (workflow.scratchpad.submitCount == 1 || gs.nil(workflow.scratchpad.orderId)) {&#13;
        return 'yes';&#13;
      }&#13;
      return 'no';&#13;
   }&#13;
</value>
        <variable display_value="">c35e50810a0a0ba96248a709b450fc32</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>dde74e4287821300297bf4bbe3e3ec36</document_key>
        <order>100</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>51e74e4287821300297bf4bbe3e3ec37</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">493cba6a0a6a803f07df24b118473551</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>dde74e4287821300297bf4bbe3e3ec36</document_key>
        <order>200</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>15e74e4287821300297bf4bbe3e3ec37</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>1</value>
        <variable display_value="">493d2c1d0a6a803f3217a75738ea3289</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>dde74e4287821300297bf4bbe3e3ec36</document_key>
        <order>300</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e74e4287821300297bf4bbe3e3ec37</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// This script needs to set answer to 'yes' or 'no' to indicate the state of the activity.&#13;
//&#13;
&#13;
   answer = ifScript();&#13;
&#13;
   function ifScript() {&#13;
	   // Decide whether to create new order or re-submit old one&#13;
	   // In case of beforeBPO failures orderID will not be generated since the task is getting created directly.&#13;
	   // Hence check for orderId as well&#13;
      if (workflow.scratchpad.submitCount == 1 || gs.nil(workflow.scratchpad.orderId)) {&#13;
        return 'yes';&#13;
      }&#13;
      return 'no';&#13;
   }&#13;
</value>
        <variable display_value="">c35e50810a0a0ba96248a709b450fc32</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="New Order?">dde74e4287821300297bf4bbe3e3ec36</activity>
        <condition>activity.result == 'no'</condition>
        <condition_default display_value="No">c1eff6430a0a0b59000f955abe842c94</condition_default>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>No</name>
        <order>200</order>
        <short_description/>
        <skip_during_generate>true</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>5de74e4287821300297bf4bbe3e3ec37</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="New Order?">dde74e4287821300297bf4bbe3e3ec36</activity>
        <condition>activity.result == 'yes'</condition>
        <condition_default display_value="Yes">c1ef63200a0a0b59005ef89bae78feb7</condition_default>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>true</is_positive>
        <name>Yes</name>
        <order>100</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d9e74e4287821300297bf4bbe3e3ec37</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Script">db8c65aec0a8016501d00259bc7203a4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>35</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Order Cancelled</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage display_value="Deployment Cancelled">c9e70e4287821300297bf4bbe3e3ec44</stage>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>49e70e4287821300297bf4bbe3e3ec46</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>1167</x>
        <y>663</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=49e70e4287821300297bf4bbe3e3ec46"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>49e70e4287821300297bf4bbe3e3ec46</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>dde70e4287821300297bf4bbe3e3ec46</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>// Close request and requested item&#13;
current.setValue('state','4'); //Closed Incomplete&#13;
var grR = new GlideRecord('sc_request'); // close the request&#13;
grR.get(current.request + '');&#13;
grR.setValue('request_state', 'closed_incomplete');&#13;
grR.setValue('stage', 'closed_incomplete');&#13;
grR.update();&#13;
CMPUtil.updateRequestItemComments(current.sys_id, "Deployment Cancelled");&#13;
workflow.info(workflow.scratchpad.error);&#13;
workflow.scratchpad.orderevent = current.sys_id + 'order';&#13;
&#13;
// Call clean up only when blueprint orchestration fails&#13;
if(!gs.nil(workflow.scratchpad.orderId)) {&#13;
	cleanup();&#13;
}&#13;
&#13;
createCloudTrail('Complete Cloud Orchestration', '4', true, 'Blueprint deployment failed', workflow.scratchpad.error);&#13;
&#13;
function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
	var catalogItemId = '' + current.cat_item;&#13;
	var requestItemId = '' + current.sys_id;&#13;
	var orderId = '' + workflow.scratchpad.orderId;&#13;
	var contextKey = '' + workflow.scratchpad.payload.contextKey;&#13;
	var stackId = '' + current.configuration_item;&#13;
	var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
	var targetInstanceId = '' + current.configuration_item;&#13;
	var userId = '' + current.request.requested_for;&#13;
	var groupId = '' + workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
	var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
}&#13;
&#13;
function cleanup() {&#13;
	// Perform clean up&#13;
	workflow.scratchpad.payload.operationName = 'Cleanup';&#13;
	workflow.scratchpad.payload.stack = '' + current.configuration_item;&#13;
&#13;
	try {&#13;
		var os= new sn_cmp_api.OrderServiceScript();&#13;
		var order = os.submitOrder(new global.JSON().encode(workflow.scratchpad.payload));&#13;
		var orderObj = new global.JSON().decode(order);&#13;
	} catch (e) {&#13;
		// NO-OP&#13;
		createCloudTrail('Complete Cloud Orchestration', '4', false, 'Exception while cleaning up', e);&#13;
	}&#13;
}</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>49e70e4287821300297bf4bbe3e3ec46</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>dde70e4287821300297bf4bbe3e3ec46</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <value>// Close request and requested item&#13;
current.setValue('state','4'); //Closed Incomplete&#13;
var grR = new GlideRecord('sc_request'); // close the request&#13;
grR.get(current.request + '');&#13;
grR.setValue('request_state', 'closed_incomplete');&#13;
grR.setValue('stage', 'closed_incomplete');&#13;
grR.update();&#13;
CMPUtil.updateRequestItemComments(current.sys_id, "Deployment Cancelled");&#13;
workflow.info(workflow.scratchpad.error);&#13;
workflow.scratchpad.orderevent = current.sys_id + 'order';&#13;
&#13;
// Call clean up only when blueprint orchestration fails&#13;
if(!gs.nil(workflow.scratchpad.orderId)) {&#13;
	cleanup();&#13;
}&#13;
&#13;
createCloudTrail('Complete Cloud Orchestration', '4', true, 'Blueprint deployment failed', workflow.scratchpad.error);&#13;
&#13;
function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
	var catalogItemId = '' + current.cat_item;&#13;
	var requestItemId = '' + current.sys_id;&#13;
	var orderId = '' + workflow.scratchpad.orderId;&#13;
	var contextKey = '' + workflow.scratchpad.payload.contextKey;&#13;
	var stackId = '' + current.configuration_item;&#13;
	var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
	var targetInstanceId = '' + current.configuration_item;&#13;
	var userId = '' + current.request.requested_for;&#13;
	var groupId = '' + workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
	var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
}&#13;
&#13;
function cleanup() {&#13;
	// Perform clean up&#13;
	workflow.scratchpad.payload.operationName = 'Cleanup';&#13;
	workflow.scratchpad.payload.stack = '' + current.configuration_item;&#13;
&#13;
	try {&#13;
		var os= new sn_cmp_api.OrderServiceScript();&#13;
		var order = os.submitOrder(new global.JSON().encode(workflow.scratchpad.payload));&#13;
		var orderObj = new global.JSON().decode(order);&#13;
	} catch (e) {&#13;
		// NO-OP&#13;
		createCloudTrail('Complete Cloud Orchestration', '4', false, 'Exception while cleaning up', e);&#13;
	}&#13;
}</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Order Cancelled">49e70e4287821300297bf4bbe3e3ec46</activity>
        <condition>true</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>true</is_positive>
        <name>Always</name>
        <order>0</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>99e70e4287821300297bf4bbe3e3ec47</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Script">db8c65aec0a8016501d00259bc7203a4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>11</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Quota Check Failed</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage display_value="Quota Check Failed">45e70e4287821300297bf4bbe3e3ec44</stage>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>55e74e4287821300297bf4bbe3e3ec35</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>261</x>
        <y>639</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=55e74e4287821300297bf4bbe3e3ec35"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>55e74e4287821300297bf4bbe3e3ec35</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e74e4287821300297bf4bbe3e3ec35</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// Set error flag for task creation&#13;
//workflow.scratchpad.beforeBPOErrorFlag = true;&#13;
CMPUtil.updateRequestItemComments(current.sys_id, "Quota Check Failed");&#13;
createCloudTrail('Check User Quota', '4', true, 'User quota exceeded', '');&#13;
&#13;
function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
	var catalogItemId = '' + current.cat_item;&#13;
	var requestItemId = '' + current.sys_id;&#13;
	var orderId ='';&#13;
	var contextKey = '';&#13;
	var stackId = '';&#13;
	var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
	var targetInstanceId = '';&#13;
	var userId = '' + current.request.requested_for;&#13;
	var groupId = '' + 	workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
	var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
}</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>55e74e4287821300297bf4bbe3e3ec35</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e74e4287821300297bf4bbe3e3ec35</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// Set error flag for task creation&#13;
//workflow.scratchpad.beforeBPOErrorFlag = true;&#13;
CMPUtil.updateRequestItemComments(current.sys_id, "Quota Check Failed");&#13;
createCloudTrail('Check User Quota', '4', true, 'User quota exceeded', '');&#13;
&#13;
function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
	var catalogItemId = '' + current.cat_item;&#13;
	var requestItemId = '' + current.sys_id;&#13;
	var orderId ='';&#13;
	var contextKey = '';&#13;
	var stackId = '';&#13;
	var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
	var targetInstanceId = '';&#13;
	var userId = '' + current.request.requested_for;&#13;
	var groupId = '' + 	workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
	var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
}</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Quota Check Failed">55e74e4287821300297bf4bbe3e3ec35</activity>
        <condition>true</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>true</is_positive>
        <name>Always</name>
        <order>0</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d9e74e4287821300297bf4bbe3e3ec35</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Script">db8c65aec0a8016501d00259bc7203a4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>36</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Quota/Capacity Check Successful</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage display_value="Quota/Capacity Check Successful">c5e70e4287821300297bf4bbe3e3ec44</stage>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>19e74e4287821300297bf4bbe3e3ec2c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>574</x>
        <y>309</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=19e74e4287821300297bf4bbe3e3ec2c"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>19e74e4287821300297bf4bbe3e3ec2c</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>99e74e4287821300297bf4bbe3e3ec2c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>19e74e4287821300297bf4bbe3e3ec2c</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>99e74e4287821300297bf4bbe3e3ec2c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Quota/Capacity Check Successful">19e74e4287821300297bf4bbe3e3ec2c</activity>
        <condition>true</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>true</is_positive>
        <name>Always</name>
        <order>0</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>9de74e4287821300297bf4bbe3e3ec2c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Script">db8c65aec0a8016501d00259bc7203a4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>29</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Resubmit Order</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage display_value="Retrying Stack Deployment">41e70e4287821300297bf4bbe3e3ec45</stage>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>95e74e4287821300297bf4bbe3e3ec2e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>829</x>
        <y>342</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=95e74e4287821300297bf4bbe3e3ec2e"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>95e74e4287821300297bf4bbe3e3ec2e</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>19e74e4287821300297bf4bbe3e3ec2e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>var bpoScript = new sn_cmp_api.BPOrchestratorServiceScript();&#13;
bpoScript.restartOrder(workflow.scratchpad.orderId);&#13;
CMPUtil.updateRequestItemComments(current.sys_id, "Order Retried");&#13;
&#13;
// If change in inputs&#13;
/*var blueprintSysid = current.cat_item.blue_print + '';&#13;
var reqItem = new GlideRecord('sc_req_item');&#13;
if(reqItem.get(current.sys_id)) {&#13;
	workflow.scratchpad.payload.orderFormData[key] = blueprintRequestUtil.resolveParamValue(reqItem.variables[key], key, blueprintSysid);&#13;
}*/&#13;
// TODO: Handle API Call failures</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>95e74e4287821300297bf4bbe3e3ec2e</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>19e74e4287821300297bf4bbe3e3ec2e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>var bpoScript = new sn_cmp_api.BPOrchestratorServiceScript();&#13;
bpoScript.restartOrder(workflow.scratchpad.orderId);&#13;
CMPUtil.updateRequestItemComments(current.sys_id, "Order Retried");&#13;
&#13;
// If change in inputs&#13;
/*var blueprintSysid = current.cat_item.blue_print + '';&#13;
var reqItem = new GlideRecord('sc_req_item');&#13;
if(reqItem.get(current.sys_id)) {&#13;
	workflow.scratchpad.payload.orderFormData[key] = blueprintRequestUtil.resolveParamValue(reqItem.variables[key], key, blueprintSysid);&#13;
}*/&#13;
// TODO: Handle API Call failures</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Resubmit Order">95e74e4287821300297bf4bbe3e3ec2e</activity>
        <condition>true</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>true</is_positive>
        <name>Always</name>
        <order>0</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>1de74e4287821300297bf4bbe3e3ec2e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Workflow">a1e18d75c33101008de24a3c5bba8fe4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>23</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Run CatItemRequestEnd WF</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage/>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e74e4287821300297bf4bbe3e3ec26</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>1628</x>
        <y>655</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=d5e74e4287821300297bf4bbe3e3ec26"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d5e74e4287821300297bf4bbe3e3ec26</document_key>
        <order>100</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>1de74e4287821300297bf4bbe3e3ec26</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>1</value>
        <variable display_value="">540d5b67c33101008de24a3c5bba8faa</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d5e74e4287821300297bf4bbe3e3ec26</document_key>
        <order>50</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>59e74e4287821300297bf4bbe3e3ec26</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>workflow.scratchpad.postProcessResult</value>
        <variable display_value="">d64cbba3c33101008de24a3c5bba8f76</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d5e74e4287821300297bf4bbe3e3ec26</document_key>
        <order>200</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>dde74e4287821300297bf4bbe3e3ec26</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// Set answer to the following value:&#13;
			// answer = {};&#13;
			// answer.workflow = 'My Sub-flow';&#13;
			// answer.inputs = {};&#13;
			// answer.inputs.u_my_input = 'Value for this input';&#13;
			// answer.inputs.u_another_input = 'another input value';&#13;
			answer = {};&#13;
			answer.workflow = workflow.scratchpad.postWF;&#13;
			answer.inputs = {};&#13;
			answer.inputs.u_payload = new global.JSON().encode(workflow.scratchpad.payload);&#13;
			// set any inputs to your sub-flow here&#13;
		</value>
        <variable display_value="">d14d5f67c33101008de24a3c5bba8f3f</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d5e74e4287821300297bf4bbe3e3ec26</document_key>
        <order>50</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>59e74e4287821300297bf4bbe3e3ec26</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>workflow.scratchpad.postProcessResult</value>
        <variable display_value="">d64cbba3c33101008de24a3c5bba8f76</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d5e74e4287821300297bf4bbe3e3ec26</document_key>
        <order>100</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>1de74e4287821300297bf4bbe3e3ec26</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>1</value>
        <variable display_value="">540d5b67c33101008de24a3c5bba8faa</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d5e74e4287821300297bf4bbe3e3ec26</document_key>
        <order>200</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>dde74e4287821300297bf4bbe3e3ec26</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// Set answer to the following value:&#13;
			// answer = {};&#13;
			// answer.workflow = 'My Sub-flow';&#13;
			// answer.inputs = {};&#13;
			// answer.inputs.u_my_input = 'Value for this input';&#13;
			// answer.inputs.u_another_input = 'another input value';&#13;
			answer = {};&#13;
			answer.workflow = workflow.scratchpad.postWF;&#13;
			answer.inputs = {};&#13;
			answer.inputs.u_payload = new global.JSON().encode(workflow.scratchpad.payload);&#13;
			// set any inputs to your sub-flow here&#13;
		</value>
        <variable display_value="">d14d5f67c33101008de24a3c5bba8f3f</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Run CatItemRequestEnd WF">d5e74e4287821300297bf4bbe3e3ec26</activity>
        <condition>activity.result != 'success'</condition>
        <condition_default display_value="Failure">b068435bc33101008de24a3c5bba8f49</condition_default>
        <condition_type>else_flag</condition_type>
        <else_flag>true</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Failure</name>
        <order>100</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d1e74e4287821300297bf4bbe3e3ec27</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Run CatItemRequestEnd WF">d5e74e4287821300297bf4bbe3e3ec26</activity>
        <condition>workflow.scratchpad.postProcessResult == 'success'</condition>
        <condition_default display_value="Success">a778871bc33101008de24a3c5bba8fc5</condition_default>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Success</name>
        <order>50</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>55e74e4287821300297bf4bbe3e3ec27</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Workflow">a1e18d75c33101008de24a3c5bba8fe4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>21</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Run CatItemRequestStart WF</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage/>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d1e74e4287821300297bf4bbe3e3ec23</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>28</x>
        <y>339</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=d1e74e4287821300297bf4bbe3e3ec23"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d1e74e4287821300297bf4bbe3e3ec23</document_key>
        <order>200</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>5de74e4287821300297bf4bbe3e3ec23</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// Set answer to the following value:&#13;
			// answer = {};&#13;
			// answer.workflow = 'My Sub-flow';&#13;
			// answer.inputs = {};&#13;
			// answer.inputs.u_my_input = 'Value for this input';&#13;
			// answer.inputs.u_another_input = 'another input value';&#13;
			answer = {};&#13;
			answer.workflow = workflow.scratchpad.preWF;&#13;
			answer.inputs = {};&#13;
			answer.inputs.u_payload = new global.JSON().encode(workflow.scratchpad.payload);&#13;
			// set any inputs to your sub-flow here&#13;
		</value>
        <variable display_value="">d14d5f67c33101008de24a3c5bba8f3f</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d1e74e4287821300297bf4bbe3e3ec23</document_key>
        <order>100</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>99e74e4287821300297bf4bbe3e3ec23</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>1</value>
        <variable display_value="">540d5b67c33101008de24a3c5bba8faa</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d1e74e4287821300297bf4bbe3e3ec23</document_key>
        <order>50</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e74e4287821300297bf4bbe3e3ec23</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>workflow.scratchpad.preProcessResult</value>
        <variable display_value="">d64cbba3c33101008de24a3c5bba8f76</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d1e74e4287821300297bf4bbe3e3ec23</document_key>
        <order>50</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e74e4287821300297bf4bbe3e3ec23</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>workflow.scratchpad.preProcessResult</value>
        <variable display_value="">d64cbba3c33101008de24a3c5bba8f76</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d1e74e4287821300297bf4bbe3e3ec23</document_key>
        <order>100</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>99e74e4287821300297bf4bbe3e3ec23</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>1</value>
        <variable display_value="">540d5b67c33101008de24a3c5bba8faa</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>d1e74e4287821300297bf4bbe3e3ec23</document_key>
        <order>200</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>5de74e4287821300297bf4bbe3e3ec23</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// Set answer to the following value:&#13;
			// answer = {};&#13;
			// answer.workflow = 'My Sub-flow';&#13;
			// answer.inputs = {};&#13;
			// answer.inputs.u_my_input = 'Value for this input';&#13;
			// answer.inputs.u_another_input = 'another input value';&#13;
			answer = {};&#13;
			answer.workflow = workflow.scratchpad.preWF;&#13;
			answer.inputs = {};&#13;
			answer.inputs.u_payload = new global.JSON().encode(workflow.scratchpad.payload);&#13;
			// set any inputs to your sub-flow here&#13;
		</value>
        <variable display_value="">d14d5f67c33101008de24a3c5bba8f3f</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Run CatItemRequestStart WF">d1e74e4287821300297bf4bbe3e3ec23</activity>
        <condition>activity.result != 'success'</condition>
        <condition_default display_value="Failure">b068435bc33101008de24a3c5bba8f49</condition_default>
        <condition_type>else_flag</condition_type>
        <else_flag>true</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Failure</name>
        <order>100</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d1e74e4287821300297bf4bbe3e3ec24</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Run CatItemRequestStart WF">d1e74e4287821300297bf4bbe3e3ec23</activity>
        <condition>workflow.scratchpad.preProcessResult == 'success'</condition>
        <condition_default display_value="Success">a778871bc33101008de24a3c5bba8fc5</condition_default>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Success</name>
        <order>50</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>55e74e4287821300297bf4bbe3e3ec24</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Workflow">a1e18d75c33101008de24a3c5bba8fe4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>15</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Run Cloud Approval WF</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage display_value="Waiting for Cloud Request Approval">49e70e4287821300297bf4bbe3e3ec45</stage>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>19e74e4287821300297bf4bbe3e3ec2a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>256</x>
        <y>204</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=19e74e4287821300297bf4bbe3e3ec2a"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>19e74e4287821300297bf4bbe3e3ec2a</document_key>
        <order>200</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>11e74e4287821300297bf4bbe3e3ec2b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// Set answer to the following value:&#13;
			// answer = {};&#13;
			// answer.workflow = 'My Sub-flow';&#13;
			// answer.inputs = {};&#13;
			// answer.inputs.u_my_input = 'Value for this input';&#13;
			// answer.inputs.u_another_input = 'another input value';&#13;
			answer = {};&#13;
			answer.workflow = workflow.scratchpad.approvalWF;&#13;
			answer.inputs = {};&#13;
			answer.inputs.approval = new global.JSON().encode(workflow.scratchpad.approvalPayload.approval);&#13;
			// set any inputs to your sub-flow here&#13;
		</value>
        <variable display_value="">d14d5f67c33101008de24a3c5bba8f3f</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>19e74e4287821300297bf4bbe3e3ec2a</document_key>
        <order>100</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>5de74e4287821300297bf4bbe3e3ec2a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>1</value>
        <variable display_value="">540d5b67c33101008de24a3c5bba8faa</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>19e74e4287821300297bf4bbe3e3ec2a</document_key>
        <order>50</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>99e74e4287821300297bf4bbe3e3ec2a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>workflow.scratchpad.approvalResult</value>
        <variable display_value="">d64cbba3c33101008de24a3c5bba8f76</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>19e74e4287821300297bf4bbe3e3ec2a</document_key>
        <order>50</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>99e74e4287821300297bf4bbe3e3ec2a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>workflow.scratchpad.approvalResult</value>
        <variable display_value="">d64cbba3c33101008de24a3c5bba8f76</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>19e74e4287821300297bf4bbe3e3ec2a</document_key>
        <order>100</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>5de74e4287821300297bf4bbe3e3ec2a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>1</value>
        <variable display_value="">540d5b67c33101008de24a3c5bba8faa</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>19e74e4287821300297bf4bbe3e3ec2a</document_key>
        <order>200</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>11e74e4287821300297bf4bbe3e3ec2b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// Set answer to the following value:&#13;
			// answer = {};&#13;
			// answer.workflow = 'My Sub-flow';&#13;
			// answer.inputs = {};&#13;
			// answer.inputs.u_my_input = 'Value for this input';&#13;
			// answer.inputs.u_another_input = 'another input value';&#13;
			answer = {};&#13;
			answer.workflow = workflow.scratchpad.approvalWF;&#13;
			answer.inputs = {};&#13;
			answer.inputs.approval = new global.JSON().encode(workflow.scratchpad.approvalPayload.approval);&#13;
			// set any inputs to your sub-flow here&#13;
		</value>
        <variable display_value="">d14d5f67c33101008de24a3c5bba8f3f</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Run Cloud Approval WF">19e74e4287821300297bf4bbe3e3ec2a</activity>
        <condition>activity.result != 'success'</condition>
        <condition_default display_value="Failure">b068435bc33101008de24a3c5bba8f49</condition_default>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Failure</name>
        <order>3</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>15e74e4287821300297bf4bbe3e3ec2b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Run Cloud Approval WF">19e74e4287821300297bf4bbe3e3ec2a</activity>
        <condition>activity.result == 'success'</condition>
        <condition_default display_value="Success">a778871bc33101008de24a3c5bba8fc5</condition_default>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Success</name>
        <order>1</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>95e74e4287821300297bf4bbe3e3ec2b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Script">db8c65aec0a8016501d00259bc7203a4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>25</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Run quota check after approval</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage/>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>15e74e4287821300297bf4bbe3e3ec2d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>816</x>
        <y>150</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=15e74e4287821300297bf4bbe3e3ec2d"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>15e74e4287821300297bf4bbe3e3ec2d</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>95e74e4287821300297bf4bbe3e3ec2d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>workflow.scratchpad.taskErrorMessage = '';&#13;
applyReqItemVariabletoLocalVars();&#13;
var result = checkQuota(workflow.scratchpad.payload);&#13;
if(result.quotaStatus &amp;&amp; result.capacityStatus)&#13;
	activity.result = 'success';&#13;
else if(!result.capacityStatus) &#13;
	activity.result = 'capacity_fail';&#13;
else &#13;
	activity.result = 'quota_fail';&#13;
&#13;
if(activity.result != 'success') {&#13;
	workflow.scratchpad.taskErrorMessage = '' + result.message;&#13;
}&#13;
&#13;
function checkQuota(orderForm) {&#13;
	var userId = ''+current.request.requested_for;&#13;
	var groupId = orderForm.orderFormData.UserGroup;&#13;
	var bpName = current.cat_item.blue_print.name + '';&#13;
	var quotaSvc = new sn_cmp_api.QuotaServiceScript();&#13;
	var ret = quotaSvc.checkQuotaForBlueprintResources(groupId, userId, bpName, &#13;
													   new global.JSON().encode(orderForm.orderFormData));&#13;
	return new global.JSON().decode(ret);&#13;
}&#13;
&#13;
function applyReqItemVariabletoLocalVars() {&#13;
	var reqItemGr = new GlideRecord('sc_req_item');&#13;
	if(reqItemGr.get(current.sys_id) &amp;&amp; !gs.nil(reqItemGr.variables.cloudTaskWorkflowInput)) {&#13;
	//if(!gs.nil(current.variables.cloudTaskWorkflowInput)) {&#13;
		var inputs = {};&#13;
		// Decode the input and store in local variables.&#13;
		inputs = new global.JSON().decode(reqItemGr.variables.cloudTaskWorkflowInput);&#13;
		//inputs = new global.JSON().decode(current.variables.cloudTaskWorkflowInput);&#13;
&#13;
	/*	workflow.scratchpad.beforeBPOErrorFlag = inputs.beforeBPOErrorFlag;&#13;
		workflow.scratchpad.afterBPOErrorFlag  = inputs.afterBPOErrorFlag;&#13;
&#13;
		workflow.scratchpad.beforeBPOSubmitCount  = inputs.beforeBPOSubmitCount;&#13;
		workflow.scratchpad.afterBPOSubmitCount  = inputs.afterBPOSubmitCount;*/&#13;
		&#13;
		workflow.scratchpad.submitCount = inputs.submitCount;&#13;
		workflow.scratchpad.operatorFlag = inputs.operatorFlag;&#13;
		workflow.scratchpad.taskSysId = inputs.taskSysId;&#13;
&#13;
		//workflow.scratchpad.orderId = inputs.orderId;&#13;
	}&#13;
}&#13;
		</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>15e74e4287821300297bf4bbe3e3ec2d</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>95e74e4287821300297bf4bbe3e3ec2d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>workflow.scratchpad.taskErrorMessage = '';&#13;
applyReqItemVariabletoLocalVars();&#13;
var result = checkQuota(workflow.scratchpad.payload);&#13;
if(result.quotaStatus &amp;&amp; result.capacityStatus)&#13;
	activity.result = 'success';&#13;
else if(!result.capacityStatus) &#13;
	activity.result = 'capacity_fail';&#13;
else &#13;
	activity.result = 'quota_fail';&#13;
&#13;
if(activity.result != 'success') {&#13;
	workflow.scratchpad.taskErrorMessage = '' + result.message;&#13;
}&#13;
&#13;
function checkQuota(orderForm) {&#13;
	var userId = ''+current.request.requested_for;&#13;
	var groupId = orderForm.orderFormData.UserGroup;&#13;
	var bpName = current.cat_item.blue_print.name + '';&#13;
	var quotaSvc = new sn_cmp_api.QuotaServiceScript();&#13;
	var ret = quotaSvc.checkQuotaForBlueprintResources(groupId, userId, bpName, &#13;
													   new global.JSON().encode(orderForm.orderFormData));&#13;
	return new global.JSON().decode(ret);&#13;
}&#13;
&#13;
function applyReqItemVariabletoLocalVars() {&#13;
	var reqItemGr = new GlideRecord('sc_req_item');&#13;
	if(reqItemGr.get(current.sys_id) &amp;&amp; !gs.nil(reqItemGr.variables.cloudTaskWorkflowInput)) {&#13;
	//if(!gs.nil(current.variables.cloudTaskWorkflowInput)) {&#13;
		var inputs = {};&#13;
		// Decode the input and store in local variables.&#13;
		inputs = new global.JSON().decode(reqItemGr.variables.cloudTaskWorkflowInput);&#13;
		//inputs = new global.JSON().decode(current.variables.cloudTaskWorkflowInput);&#13;
&#13;
	/*	workflow.scratchpad.beforeBPOErrorFlag = inputs.beforeBPOErrorFlag;&#13;
		workflow.scratchpad.afterBPOErrorFlag  = inputs.afterBPOErrorFlag;&#13;
&#13;
		workflow.scratchpad.beforeBPOSubmitCount  = inputs.beforeBPOSubmitCount;&#13;
		workflow.scratchpad.afterBPOSubmitCount  = inputs.afterBPOSubmitCount;*/&#13;
		&#13;
		workflow.scratchpad.submitCount = inputs.submitCount;&#13;
		workflow.scratchpad.operatorFlag = inputs.operatorFlag;&#13;
		workflow.scratchpad.taskSysId = inputs.taskSysId;&#13;
&#13;
		//workflow.scratchpad.orderId = inputs.orderId;&#13;
	}&#13;
}&#13;
		</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Run quota check after approval">15e74e4287821300297bf4bbe3e3ec2d</activity>
        <condition>activity.state == 'faulted'</condition>
        <condition_default/>
        <condition_type>else_flag</condition_type>
        <else_flag>true</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Error</name>
        <order>4</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>1de74e4287821300297bf4bbe3e3ec2d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Run quota check after approval">15e74e4287821300297bf4bbe3e3ec2d</activity>
        <condition>activity.result == 'capacity_fail' &amp;&amp; activity.state != 'faulted'</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>on capacity check failure</name>
        <order>3</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>99e74e4287821300297bf4bbe3e3ec2d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Run quota check after approval">15e74e4287821300297bf4bbe3e3ec2d</activity>
        <condition>activity.result == 'quota_fail' &amp;&amp; activity.state != 'faulted'</condition>
        <condition_default/>
        <condition_type>else_flag</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>on quota check failure</name>
        <order>2</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>9de74e4287821300297bf4bbe3e3ec2d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Run quota check after approval">15e74e4287821300297bf4bbe3e3ec2d</activity>
        <condition>activity.result == 'success' &amp;&amp; activity.state != 'faulted'</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Success</name>
        <order>1</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>11e74e4287821300297bf4bbe3e3ec2e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Workflow">a1e18d75c33101008de24a3c5bba8fe4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>34</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Run Task Processing WF</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage/>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>9de74e4287821300297bf4bbe3e3ec2f</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-15 18:29:16</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>1168</x>
        <y>526</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=9de74e4287821300297bf4bbe3e3ec2f"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>9de74e4287821300297bf4bbe3e3ec2f</document_key>
        <order>50</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>11e74e4287821300297bf4bbe3e3ec30</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>workflow.scratchpad.taskResult</value>
        <variable display_value="">d64cbba3c33101008de24a3c5bba8f76</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>9de74e4287821300297bf4bbe3e3ec2f</document_key>
        <order>200</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>95e74e4287821300297bf4bbe3e3ec30</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-15 18:29:16</sys_updated_on>
        <value>// Set answer to the following value:&#13;
// answer = {};&#13;
// answer.workflow = 'My Sub-flow';&#13;
// answer.inputs = {};&#13;
// answer.inputs.u_my_input = 'Value for this input';&#13;
// answer.inputs.u_another_input = 'another input value';&#13;
&#13;
CMPUtil.updateRequestItemComments(current.sys_id, "Error in Deployment"); &#13;
// Change stack status to retrying&#13;
if(!gs.nil(workflow.scratchpad.orderId)) {&#13;
	var orderGr = new GlideRecord('sn_cmp_order');&#13;
	if(orderGr.get(workflow.scratchpad.orderId)) {&#13;
		var stackId = orderGr.stack + '';&#13;
		var stackGr = new GlideRecord('sn_cmp_stack');&#13;
		if(!gs.nil(stackId) &amp;&amp; stackGr.get(stackId)) {&#13;
			stackGr.stack_status = 8; // Retrying&#13;
			stackGr.update();&#13;
		}&#13;
	}&#13;
} &#13;
&#13;
// Set the variable which will be consumed by this subflow&#13;
var inputs = {};&#13;
inputs.orderId = workflow.scratchpad.orderId;&#13;
&#13;
workflow.scratchpad.errorCount += 1;&#13;
inputs.submitCount = workflow.scratchpad.submitCount;&#13;
inputs.taskErrorMessage = workflow.scratchpad.taskErrorMessage;&#13;
inputs.operatorFlag = workflow.scratchpad.operatorFlag;&#13;
inputs.taskSysId = workflow.scratchpad.taskSysId;&#13;
&#13;
new global.CmpSCUtil().addOptions(current.sys_id, 'cloudTaskWorkflowInput', new global.JSON().encode(inputs));&#13;
&#13;
answer = {};&#13;
answer.workflow = workflow.scratchpad.taskWFName;&#13;
answer.inputs = {};&#13;
&#13;
&#13;
&#13;
</value>
        <variable display_value="">d14d5f67c33101008de24a3c5bba8f3f</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>9de74e4287821300297bf4bbe3e3ec2f</document_key>
        <order>100</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d1e74e4287821300297bf4bbe3e3ec30</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>1</value>
        <variable display_value="">540d5b67c33101008de24a3c5bba8faa</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>9de74e4287821300297bf4bbe3e3ec2f</document_key>
        <order>50</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>11e74e4287821300297bf4bbe3e3ec30</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>workflow.scratchpad.taskResult</value>
        <variable display_value="">d64cbba3c33101008de24a3c5bba8f76</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>9de74e4287821300297bf4bbe3e3ec2f</document_key>
        <order>100</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d1e74e4287821300297bf4bbe3e3ec30</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>1</value>
        <variable display_value="">540d5b67c33101008de24a3c5bba8faa</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>9de74e4287821300297bf4bbe3e3ec2f</document_key>
        <order>200</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>95e74e4287821300297bf4bbe3e3ec30</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-15 18:29:16</sys_updated_on>
        <value>// Set answer to the following value:&#13;
// answer = {};&#13;
// answer.workflow = 'My Sub-flow';&#13;
// answer.inputs = {};&#13;
// answer.inputs.u_my_input = 'Value for this input';&#13;
// answer.inputs.u_another_input = 'another input value';&#13;
&#13;
CMPUtil.updateRequestItemComments(current.sys_id, "Error in Deployment"); &#13;
// Change stack status to retrying&#13;
if(!gs.nil(workflow.scratchpad.orderId)) {&#13;
	var orderGr = new GlideRecord('sn_cmp_order');&#13;
	if(orderGr.get(workflow.scratchpad.orderId)) {&#13;
		var stackId = orderGr.stack + '';&#13;
		var stackGr = new GlideRecord('sn_cmp_stack');&#13;
		if(!gs.nil(stackId) &amp;&amp; stackGr.get(stackId)) {&#13;
			stackGr.stack_status = 8; // Retrying&#13;
			stackGr.update();&#13;
		}&#13;
	}&#13;
} &#13;
&#13;
// Set the variable which will be consumed by this subflow&#13;
var inputs = {};&#13;
inputs.orderId = workflow.scratchpad.orderId;&#13;
&#13;
workflow.scratchpad.errorCount += 1;&#13;
inputs.submitCount = workflow.scratchpad.submitCount;&#13;
inputs.taskErrorMessage = workflow.scratchpad.taskErrorMessage;&#13;
inputs.operatorFlag = workflow.scratchpad.operatorFlag;&#13;
inputs.taskSysId = workflow.scratchpad.taskSysId;&#13;
&#13;
new global.CmpSCUtil().addOptions(current.sys_id, 'cloudTaskWorkflowInput', new global.JSON().encode(inputs));&#13;
&#13;
answer = {};&#13;
answer.workflow = workflow.scratchpad.taskWFName;&#13;
answer.inputs = {};&#13;
&#13;
&#13;
&#13;
</value>
        <variable display_value="">d14d5f67c33101008de24a3c5bba8f3f</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Run Task Processing WF">9de74e4287821300297bf4bbe3e3ec2f</activity>
        <condition>activity.result != 'success'</condition>
        <condition_default display_value="Failure">b068435bc33101008de24a3c5bba8f49</condition_default>
        <condition_type>else_flag</condition_type>
        <else_flag>true</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Failure</name>
        <order>100</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>1de74e4287821300297bf4bbe3e3ec30</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Run Task Processing WF">9de74e4287821300297bf4bbe3e3ec2f</activity>
        <condition>workflow.scratchpad.taskResult == 'success'</condition>
        <condition_default display_value="Success">a778871bc33101008de24a3c5bba8fc5</condition_default>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Success</name>
        <order>50</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>99e74e4287821300297bf4bbe3e3ec30</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Run Script">db8c65aec0a8016501d00259bc7203a4</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>9</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Success</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage display_value="Deployment Successful">49e70e4287821300297bf4bbe3e3ec44</stage>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>91e74e4287821300297bf4bbe3e3ec2f</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>1621</x>
        <y>381</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=91e74e4287821300297bf4bbe3e3ec2f"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e74e4287821300297bf4bbe3e3ec2f</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>15e74e4287821300297bf4bbe3e3ec2f</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>current.setValue('state','3'); // Closed complete&#13;
var grR = new GlideRecord('sc_request'); // close the request&#13;
grR.get(current.request + '');&#13;
grR.setValue('request_state', 'closed_complete');&#13;
grR.setValue('stage', 'closed_complete');&#13;
grR.update();&#13;
CMPUtil.updateRequestItemComments(current.sys_id, "Deployment Successful");&#13;
&#13;
&#13;
createCloudTrail('Complete Cloud Orchestration', '2', true, 'Blueprint deployment successful', '');&#13;
&#13;
function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
	var catalogItemId = '' + current.cat_item;&#13;
	var requestItemId = '' + current.sys_id;&#13;
	var orderId = '' + workflow.scratchpad.orderId;&#13;
	var contextKey = '' + workflow.scratchpad.payload.contextKey;&#13;
	var stackId = '' + current.configuration_item;&#13;
	var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
	var targetInstanceId = '' + current.configuration_item;&#13;
	var userId = '' + current.request.requested_for;&#13;
	var groupId = '' + workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
	var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
}</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e74e4287821300297bf4bbe3e3ec2f</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>15e74e4287821300297bf4bbe3e3ec2f</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>current.setValue('state','3'); // Closed complete&#13;
var grR = new GlideRecord('sc_request'); // close the request&#13;
grR.get(current.request + '');&#13;
grR.setValue('request_state', 'closed_complete');&#13;
grR.setValue('stage', 'closed_complete');&#13;
grR.update();&#13;
CMPUtil.updateRequestItemComments(current.sys_id, "Deployment Successful");&#13;
&#13;
&#13;
createCloudTrail('Complete Cloud Orchestration', '2', true, 'Blueprint deployment successful', '');&#13;
&#13;
function createCloudTrail(step, messageType, milestone, messageSummary, messageDetails) {&#13;
	var catalogItemId = '' + current.cat_item;&#13;
	var requestItemId = '' + current.sys_id;&#13;
	var orderId = '' + workflow.scratchpad.orderId;&#13;
	var contextKey = '' + workflow.scratchpad.payload.contextKey;&#13;
	var stackId = '' + current.configuration_item;&#13;
	var invocationTemplateId = '' + current.cat_item.blue_print;&#13;
	var targetInstanceId = '' + current.configuration_item;&#13;
	var userId = '' + current.request.requested_for;&#13;
	var groupId = '' + workflow.scratchpad.payload.orderFormData.UserGroup;&#13;
	var trailId = new AddCloudTrail().createTrailRecord(catalogItemId, requestItemId, orderId, contextKey, stackId, invocationTemplateId, targetInstanceId, messageType, milestone, messageDetails, messageSummary, step, userId, groupId);&#13;
}</value>
        <variable display_value="">c35ddef20a0a0ba96248a7090eccd518</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Success">91e74e4287821300297bf4bbe3e3ec2f</activity>
        <condition>true</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>true</is_positive>
        <name>Always</name>
        <order>0</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>19e74e4287821300297bf4bbe3e3ec2f</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Timer">3961a1da0a0a0b5c00ecd84822f70d85</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>24</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Wait for a second</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage/>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>91e70e4287821300297bf4bbe3e3ec4c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>24</x>
        <y>88</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=91e70e4287821300297bf4bbe3e3ec4c"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>310</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>15e74e4287821300297bf4bbe3e3ec22</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">21f80cd00a0a0b2101fcd5b5defc0810</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1360</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>19e74e4287821300297bf4bbe3e3ec21</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">292b2f0e0a0a0b215aa2dd2cbc578dc5</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1350</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>1de70e4287821300297bf4bbe3e3ec4c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">4cc836da0a0a0b520083ebc07da2f47c</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1360</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>51e74e4287821300297bf4bbe3e3ec22</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">292c91070a0a0b212543d91ffde5014c</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1310</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>55e70e4287821300297bf4bbe3e3ec4d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>1970-01-01 00:00:01</value>
        <variable display_value="">c35dc0df0a0a0ba96248a7098d737925</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1360</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>55e74e4287821300297bf4bbe3e3ec21</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">292bd15e0a0a0b215a040c701033e3c5</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>500</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>59e70e4287821300297bf4bbe3e3ec4c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">220dc5a40a0a0b2109fbd28b8c4b6213</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>3000</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>91e70e4287821300297bf4bbe3e3ec4d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// Set 'answer' to the number of seconds this timer should wait&#13;
			answer = 0;</value>
        <variable display_value="">293493710a0a0b2115e3e5b4fce1d12a</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1310</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>91e74e4287821300297bf4bbe3e3ec21</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">21fd462c0a0a0b211c997276d7806c03</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>320</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>95e70e4287821300297bf4bbe3e3ec4c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">4cba34da0a0a0b5200798c86eafe1203</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1320</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>9de74e4287821300297bf4bbe3e3ec21</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">4cc6788c0a0a0b5200e6743c94001b16</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1350</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e74e4287821300297bf4bbe3e3ec22</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">4cc740fe0a0a0b520025dcf8e2ff78e7</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1320</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d9e74e4287821300297bf4bbe3e3ec21</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>08fcd0830a0a0b2600079f56b1adb9ae</value>
        <variable display_value="">4cc4a4030a0a0b52007334f001376dc5</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>350</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>dde70e4287821300297bf4bbe3e3ec4c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">4cbfe48a0a0a0b5200cf8b82cc6685f1</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1310</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>dde74e4287821300297bf4bbe3e3ec20</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>3bf802c20a0a0b52008e2859cd8abcf2</value>
        <variable display_value="">220cd53d0a0a0b214103bdc2ec5c7ab4</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>310</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>15e74e4287821300297bf4bbe3e3ec22</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">21f80cd00a0a0b2101fcd5b5defc0810</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>320</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>95e70e4287821300297bf4bbe3e3ec4c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">4cba34da0a0a0b5200798c86eafe1203</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>350</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>dde70e4287821300297bf4bbe3e3ec4c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">4cbfe48a0a0a0b5200cf8b82cc6685f1</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>500</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>59e70e4287821300297bf4bbe3e3ec4c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">220dc5a40a0a0b2109fbd28b8c4b6213</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1310</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>55e70e4287821300297bf4bbe3e3ec4d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>1970-01-01 00:00:01</value>
        <variable display_value="">c35dc0df0a0a0ba96248a7098d737925</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1310</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>91e74e4287821300297bf4bbe3e3ec21</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">21fd462c0a0a0b211c997276d7806c03</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1310</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>dde74e4287821300297bf4bbe3e3ec20</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>3bf802c20a0a0b52008e2859cd8abcf2</value>
        <variable display_value="">220cd53d0a0a0b214103bdc2ec5c7ab4</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1320</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>9de74e4287821300297bf4bbe3e3ec21</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">4cc6788c0a0a0b5200e6743c94001b16</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1320</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d9e74e4287821300297bf4bbe3e3ec21</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>08fcd0830a0a0b2600079f56b1adb9ae</value>
        <variable display_value="">4cc4a4030a0a0b52007334f001376dc5</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1350</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>1de70e4287821300297bf4bbe3e3ec4c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">4cc836da0a0a0b520083ebc07da2f47c</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1350</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e74e4287821300297bf4bbe3e3ec22</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">4cc740fe0a0a0b520025dcf8e2ff78e7</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1360</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>19e74e4287821300297bf4bbe3e3ec21</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">292b2f0e0a0a0b215aa2dd2cbc578dc5</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1360</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>51e74e4287821300297bf4bbe3e3ec22</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">292c91070a0a0b212543d91ffde5014c</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>1360</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>55e74e4287821300297bf4bbe3e3ec21</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value/>
        <variable display_value="">292bd15e0a0a0b215a040c701033e3c5</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>91e70e4287821300297bf4bbe3e3ec4c</document_key>
        <order>3000</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>91e70e4287821300297bf4bbe3e3ec4d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>// Set 'answer' to the number of seconds this timer should wait&#13;
			answer = 0;</value>
        <variable display_value="">293493710a0a0b2115e3e5b4fce1d12a</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Wait for a second">91e70e4287821300297bf4bbe3e3ec4c</activity>
        <condition>true</condition>
        <condition_default/>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>true</is_positive>
        <name>Always</name>
        <order>0</order>
        <short_description/>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>5de74e4287821300297bf4bbe3e3ec22</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_activity action="INSERT_OR_UPDATE">
        <activity_definition display_value="Wait for WF Event">88fbebdcac146426045370ed7901e2e2</activity_definition>
        <activity_definition_updated>false</activity_definition_updated>
        <databus_lookup_id>13</databus_lookup_id>
        <height/>
        <input>{}</input>
        <is_parent>false</is_parent>
        <name>Wait for order deployment</name>
        <new_activity_definition/>
        <notes/>
        <out_of_date>false</out_of_date>
        <parent/>
        <pinned>false</pinned>
        <pinned_version/>
        <stage display_value="Deploying Stack">41e70e4287821300297bf4bbe3e3ec44</stage>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>19e74e4287821300297bf4bbe3e3ec28</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <timeout>1970-01-01 00:00:00</timeout>
        <vars/>
        <width/>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
        <x>1582</x>
        <y>104</y>
    </wf_activity>
    <sys_variable_value action="delete_multiple" query="document_key=19e74e4287821300297bf4bbe3e3ec28"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>19e74e4287821300297bf4bbe3e3ec28</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>1de74e4287821300297bf4bbe3e3ec28</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>${workflow.scratchpad.orderevent}</value>
        <variable display_value="">c35dfb0f0a0a0ba96248a70973bbf0d9</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>wf_activity</document>
        <document_key>19e74e4287821300297bf4bbe3e3ec28</document_key>
        <order>1</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>1de74e4287821300297bf4bbe3e3ec28</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <value>${workflow.scratchpad.orderevent}</value>
        <variable display_value="">c35dfb0f0a0a0ba96248a70973bbf0d9</variable>
    </sys_variable_value>
    <wf_condition action="INSERT_OR_UPDATE">
        <activity display_value="Wait for order deployment">19e74e4287821300297bf4bbe3e3ec28</activity>
        <condition>activity.state == 'finished'</condition>
        <condition_default display_value="Fired">8902eeb7ac14642602e00b12fc7059c0</condition_default>
        <condition_type>standard</condition_type>
        <else_flag>false</else_flag>
        <error>false</error>
        <event>false</event>
        <event_name/>
        <is_positive>false</is_positive>
        <name>Fired</name>
        <order>1</order>
        <short_description>The event we were waiting on has been fired</short_description>
        <skip_during_generate>false</skip_during_generate>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>91e74e4287821300297bf4bbe3e3ec29</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
    </wf_condition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="skip">d9e74e4287821300297bf4bbe3e3ec34</condition>
        <from display_value="Apply BlueprintProvision Policy">55e74e4287821300297bf4bbe3e3ec34</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>11e74e4287821300297bf4bbe3e3ec3b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Check Quota">dde70e4287821300297bf4bbe3e3ec49</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Failure">15e74e4287821300297bf4bbe3e3ec2b</condition>
        <from display_value="Run Cloud Approval WF">19e74e4287821300297bf4bbe3e3ec2a</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>11e74e4287821300297bf4bbe3e3ec3d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Deployment Failed">d1e70e4287821300297bf4bbe3e3ec49</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="on quota check failure">55e70e4287821300297bf4bbe3e3ec4a</condition>
        <from display_value="Check Quota">dde70e4287821300297bf4bbe3e3ec49</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>11e74e4287821300297bf4bbe3e3ec3e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Quota Check Failed">55e74e4287821300297bf4bbe3e3ec35</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Success">51e74e4287821300297bf4bbe3e3ec26</condition>
        <from display_value="done?">d5e74e4287821300297bf4bbe3e3ec25</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>11e74e4287821300297bf4bbe3e3ec3f</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Success">91e74e4287821300297bf4bbe3e3ec2f</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="No">dde74e4287821300297bf4bbe3e3ec32</condition>
        <from display_value="Is cloud request approved?">dde74e4287821300297bf4bbe3e3ec31</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>11e74e4287821300297bf4bbe3e3ec40</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Cloud request rejected">d9e74e4287821300297bf4bbe3e3ec24</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="abort">dde74e4287821300297bf4bbe3e3ec34</condition>
        <from display_value="Apply BlueprintProvision Policy">55e74e4287821300297bf4bbe3e3ec34</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>15e74e4287821300297bf4bbe3e3ec3b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Deployment Failed">d1e70e4287821300297bf4bbe3e3ec49</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="abort">59e70e4287821300297bf4bbe3e3ec4b</condition>
        <from display_value="Apply BlueprintProvisionApproval Policy">51e70e4287821300297bf4bbe3e3ec4b</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>15e74e4287821300297bf4bbe3e3ec3c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Deployment Failed">d1e70e4287821300297bf4bbe3e3ec49</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="error">d1e74e4287821300297bf4bbe3e3ec33</condition>
        <from display_value="Is cloud request approved?">dde74e4287821300297bf4bbe3e3ec31</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>15e74e4287821300297bf4bbe3e3ec40</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Deployment Failed">d1e70e4287821300297bf4bbe3e3ec49</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Always">19e74e4287821300297bf4bbe3e3ec2f</condition>
        <from display_value="Success">91e74e4287821300297bf4bbe3e3ec2f</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>15e74e4287821300297bf4bbe3e3ec41</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Apply CatItemRequestEnd Policy">d1e70e4287821300297bf4bbe3e3ec48</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="skip">d9e70e4287821300297bf4bbe3e3ec4b</condition>
        <from display_value="Apply BlueprintProvisionApproval Policy">51e70e4287821300297bf4bbe3e3ec4b</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>19e74e4287821300297bf4bbe3e3ec3c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Cloud Request Approved">d1e74e4287821300297bf4bbe3e3ec38</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Failure">d1e74e4287821300297bf4bbe3e3ec24</condition>
        <from display_value="Run CatItemRequestStart WF">d1e74e4287821300297bf4bbe3e3ec23</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>19e74e4287821300297bf4bbe3e3ec3f</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Deployment Failed">d1e70e4287821300297bf4bbe3e3ec49</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Success">d5e70e4287821300297bf4bbe3e3ec4a</condition>
        <from display_value="Check Quota">dde70e4287821300297bf4bbe3e3ec49</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>1de74e4287821300297bf4bbe3e3ec3d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Apply BlueprintProvisionApproval Policy">51e70e4287821300297bf4bbe3e3ec4b</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Failure">dde74e4287821300297bf4bbe3e3ec25</condition>
        <from display_value="done?">d5e74e4287821300297bf4bbe3e3ec25</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>1de74e4287821300297bf4bbe3e3ec3e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Run Task Processing WF">9de74e4287821300297bf4bbe3e3ec2f</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Success">55e74e4287821300297bf4bbe3e3ec27</condition>
        <from display_value="Run CatItemRequestEnd WF">d5e74e4287821300297bf4bbe3e3ec26</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>1de74e4287821300297bf4bbe3e3ec40</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="End">d1e74e4287821300297bf4bbe3e3ec31</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="on quota check failure">9de74e4287821300297bf4bbe3e3ec2d</condition>
        <from display_value="Run quota check after approval">15e74e4287821300297bf4bbe3e3ec2d</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>51e74e4287821300297bf4bbe3e3ec3a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Quota Check Failed">55e74e4287821300297bf4bbe3e3ec35</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Always">1de74e4287821300297bf4bbe3e3ec2e</condition>
        <from display_value="Resubmit Order">95e74e4287821300297bf4bbe3e3ec2e</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>51e74e4287821300297bf4bbe3e3ec3c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="done?">d5e74e4287821300297bf4bbe3e3ec25</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Always">59e74e4287821300297bf4bbe3e3ec38</condition>
        <from display_value="Cloud Request Approved">d1e74e4287821300297bf4bbe3e3ec38</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>51e74e4287821300297bf4bbe3e3ec41</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Quota/Capacity Check Successful">19e74e4287821300297bf4bbe3e3ec2c</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="abort">11e74e4287821300297bf4bbe3e3ec2a</condition>
        <from display_value="Apply CatItemRequestStart Policy">19e74e4287821300297bf4bbe3e3ec29</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>55e74e4287821300297bf4bbe3e3ec3d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Deployment Failed">d1e70e4287821300297bf4bbe3e3ec49</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="No">5de74e4287821300297bf4bbe3e3ec37</condition>
        <from display_value="New Order?">dde74e4287821300297bf4bbe3e3ec36</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>55e74e4287821300297bf4bbe3e3ec3f</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Resubmit Order">95e74e4287821300297bf4bbe3e3ec2e</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="abort">5de70e4287821300297bf4bbe3e3ec48</condition>
        <from display_value="Apply CatItemRequestEnd Policy">d1e70e4287821300297bf4bbe3e3ec48</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>59e74e4287821300297bf4bbe3e3ec3b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="End">d1e74e4287821300297bf4bbe3e3ec31</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Always">5de74e4287821300297bf4bbe3e3ec22</condition>
        <from display_value="Wait for a second">91e70e4287821300297bf4bbe3e3ec4c</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>59e74e4287821300297bf4bbe3e3ec3e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Apply CatItemRequestStart Policy">19e74e4287821300297bf4bbe3e3ec29</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Success">99e74e4287821300297bf4bbe3e3ec30</condition>
        <from display_value="Run Task Processing WF">9de74e4287821300297bf4bbe3e3ec2f</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>59e74e4287821300297bf4bbe3e3ec40</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Run quota check after approval">15e74e4287821300297bf4bbe3e3ec2d</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Error">1de74e4287821300297bf4bbe3e3ec2d</condition>
        <from display_value="Run quota check after approval">15e74e4287821300297bf4bbe3e3ec2d</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>5de74e4287821300297bf4bbe3e3ec39</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Deployment Failed">d1e70e4287821300297bf4bbe3e3ec49</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Always">59e70e4287821300297bf4bbe3e3ec49</condition>
        <from display_value="Deployment Failed">d1e70e4287821300297bf4bbe3e3ec49</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>5de74e4287821300297bf4bbe3e3ec3a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="End">d1e74e4287821300297bf4bbe3e3ec31</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Always">9de74e4287821300297bf4bbe3e3ec2c</condition>
        <from display_value="Quota/Capacity Check Successful">19e74e4287821300297bf4bbe3e3ec2c</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>5de74e4287821300297bf4bbe3e3ec3f</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="New Order?">dde74e4287821300297bf4bbe3e3ec36</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Success">5de74e4287821300297bf4bbe3e3ec34</condition>
        <from display_value="Apply BlueprintProvision Policy">55e74e4287821300297bf4bbe3e3ec34</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>91e74e4287821300297bf4bbe3e3ec3b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Check Quota">dde70e4287821300297bf4bbe3e3ec49</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Yes">51e74e4287821300297bf4bbe3e3ec33</condition>
        <from display_value="Is cloud request approved?">dde74e4287821300297bf4bbe3e3ec31</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>91e74e4287821300297bf4bbe3e3ec40</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Cloud Request Approved">1de74e4287821300297bf4bbe3e3ec2b</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="success">d5e70e4287821300297bf4bbe3e3ec4b</condition>
        <from display_value="Apply BlueprintProvisionApproval Policy">51e70e4287821300297bf4bbe3e3ec4b</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>95e74e4287821300297bf4bbe3e3ec3c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Run Cloud Approval WF">19e74e4287821300297bf4bbe3e3ec2a</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Always">51e74e4287821300297bf4bbe3e3ec28</condition>
        <from display_value="Capacity Check Failed">d9e74e4287821300297bf4bbe3e3ec27</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>95e74e4287821300297bf4bbe3e3ec3e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Run Task Processing WF">9de74e4287821300297bf4bbe3e3ec2f</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Always">51e74e4287821300297bf4bbe3e3ec25</condition>
        <from display_value="Cloud request rejected">d9e74e4287821300297bf4bbe3e3ec24</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>99e74e4287821300297bf4bbe3e3ec39</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Deployment Failed">d1e70e4287821300297bf4bbe3e3ec49</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Fired">91e74e4287821300297bf4bbe3e3ec29</condition>
        <from display_value="Wait for order deployment">19e74e4287821300297bf4bbe3e3ec28</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>99e74e4287821300297bf4bbe3e3ec3a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="done?">d5e74e4287821300297bf4bbe3e3ec25</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="on capacity check failure">d9e70e4287821300297bf4bbe3e3ec4a</condition>
        <from display_value="Check Quota">dde70e4287821300297bf4bbe3e3ec49</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>99e74e4287821300297bf4bbe3e3ec3d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Capacity Check Failed">d9e74e4287821300297bf4bbe3e3ec27</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Success">55e74e4287821300297bf4bbe3e3ec24</condition>
        <from display_value="Run CatItemRequestStart WF">d1e74e4287821300297bf4bbe3e3ec23</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>99e74e4287821300297bf4bbe3e3ec3f</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Apply BlueprintProvision Policy">55e74e4287821300297bf4bbe3e3ec34</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Always">dde74e4287821300297bf4bbe3e3ec33</condition>
        <from display_value="Execute Cloud Orchestration Service">59e74e4287821300297bf4bbe3e3ec33</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>9de74e4287821300297bf4bbe3e3ec3b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="done?">d5e74e4287821300297bf4bbe3e3ec25</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Success">95e74e4287821300297bf4bbe3e3ec2b</condition>
        <from display_value="Run Cloud Approval WF">19e74e4287821300297bf4bbe3e3ec2a</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>9de74e4287821300297bf4bbe3e3ec3c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Is cloud request approved?">dde74e4287821300297bf4bbe3e3ec31</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Error">59e70e4287821300297bf4bbe3e3ec4a</condition>
        <from display_value="Check Quota">dde70e4287821300297bf4bbe3e3ec49</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>9de74e4287821300297bf4bbe3e3ec3d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Deployment Failed">d1e70e4287821300297bf4bbe3e3ec49</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Retry">5de74e4287821300297bf4bbe3e3ec25</condition>
        <from display_value="done?">d5e74e4287821300297bf4bbe3e3ec25</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>9de74e4287821300297bf4bbe3e3ec3e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Wait for order deployment">19e74e4287821300297bf4bbe3e3ec28</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Failure">d1e74e4287821300297bf4bbe3e3ec27</condition>
        <from display_value="Run CatItemRequestEnd WF">d5e74e4287821300297bf4bbe3e3ec26</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>9de74e4287821300297bf4bbe3e3ec40</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="End">d1e74e4287821300297bf4bbe3e3ec31</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Success">11e74e4287821300297bf4bbe3e3ec2e</condition>
        <from display_value="Run quota check after approval">15e74e4287821300297bf4bbe3e3ec2d</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d1e74e4287821300297bf4bbe3e3ec3a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Quota/Capacity Check Successful">19e74e4287821300297bf4bbe3e3ec2c</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="skip ">9de74e4287821300297bf4bbe3e3ec29</condition>
        <from display_value="Apply CatItemRequestStart Policy">19e74e4287821300297bf4bbe3e3ec29</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d1e74e4287821300297bf4bbe3e3ec3d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Apply BlueprintProvision Policy">55e74e4287821300297bf4bbe3e3ec34</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Always">d9e74e4287821300297bf4bbe3e3ec35</condition>
        <from display_value="Quota Check Failed">55e74e4287821300297bf4bbe3e3ec35</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d1e74e4287821300297bf4bbe3e3ec3e</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Run Task Processing WF">9de74e4287821300297bf4bbe3e3ec2f</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Yes">d9e74e4287821300297bf4bbe3e3ec37</condition>
        <from display_value="New Order?">dde74e4287821300297bf4bbe3e3ec36</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d1e74e4287821300297bf4bbe3e3ec3f</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Execute Cloud Orchestration Service">59e74e4287821300297bf4bbe3e3ec33</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Always">99e70e4287821300297bf4bbe3e3ec47</condition>
        <from display_value="Order Cancelled">49e70e4287821300297bf4bbe3e3ec46</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e74e4287821300297bf4bbe3e3ec3a</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="End">d1e74e4287821300297bf4bbe3e3ec31</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Apply post-processing">59e70e4287821300297bf4bbe3e3ec48</condition>
        <from display_value="Apply CatItemRequestEnd Policy">d1e70e4287821300297bf4bbe3e3ec48</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e74e4287821300297bf4bbe3e3ec3b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Run CatItemRequestEnd WF">d5e74e4287821300297bf4bbe3e3ec26</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Apply pre-processing">91e74e4287821300297bf4bbe3e3ec2a</condition>
        <from display_value="Apply CatItemRequestStart Policy">19e74e4287821300297bf4bbe3e3ec29</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e74e4287821300297bf4bbe3e3ec3d</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Run CatItemRequestStart WF">d1e74e4287821300297bf4bbe3e3ec23</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Failure">1de74e4287821300297bf4bbe3e3ec30</condition>
        <from display_value="Run Task Processing WF">9de74e4287821300297bf4bbe3e3ec2f</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e74e4287821300297bf4bbe3e3ec40</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Order Cancelled">49e70e4287821300297bf4bbe3e3ec46</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Always">59e74e4287821300297bf4bbe3e3ec36</condition>
        <from display_value="Begin">91e74e4287821300297bf4bbe3e3ec36</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d5e74e4287821300297bf4bbe3e3ec41</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Wait for a second">91e70e4287821300297bf4bbe3e3ec4c</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="skip">d9e70e4287821300297bf4bbe3e3ec48</condition>
        <from display_value="Apply CatItemRequestEnd Policy">d1e70e4287821300297bf4bbe3e3ec48</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d9e74e4287821300297bf4bbe3e3ec3b</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="End">d1e74e4287821300297bf4bbe3e3ec31</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="Always">91e74e4287821300297bf4bbe3e3ec2c</condition>
        <from display_value="Cloud Request Approved">1de74e4287821300297bf4bbe3e3ec2b</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>d9e74e4287821300297bf4bbe3e3ec3c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Run quota check after approval">15e74e4287821300297bf4bbe3e3ec2d</to>
    </wf_transition>
    <wf_transition action="INSERT_OR_UPDATE">
        <condition display_value="on capacity check failure">99e74e4287821300297bf4bbe3e3ec2d</condition>
        <from display_value="Run quota check after approval">15e74e4287821300297bf4bbe3e3ec2d</from>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:09</sys_created_on>
        <sys_id>dde74e4287821300297bf4bbe3e3ec39</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:09</sys_updated_on>
        <to display_value="Capacity Check Failed">d9e74e4287821300297bf4bbe3e3ec27</to>
    </wf_transition>
    <wf_estimated_runtime_config action="INSERT_OR_UPDATE">
        <estimated_run_time/>
        <no_of_data_points>1</no_of_data_points>
        <percentage_threshold_ert>20</percentage_threshold_ert>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-05-14 23:32:08</sys_created_on>
        <sys_id>c9e70e4287821300297bf4bbe3e3ec42</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-05-14 23:32:08</sys_updated_on>
        <workflow_version display_value="Blueprint Request">c5e70e4287821300297bf4bbe3e3ec42</workflow_version>
    </wf_estimated_runtime_config>
    <wf_workflow_version action="update_multiple" query="workflow=2cbfd46eeb352200979aa5115206fe99^sys_id!=c5e70e4287821300297bf4bbe3e3ec42">
        <published>false</published>
    </wf_workflow_version>
</record_update>
